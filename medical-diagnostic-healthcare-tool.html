<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Series: Diagnostic Test Evaluation in Healthcare & ROC Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;0,900;1,400&family=Nunito:ital,wght@0,300;0,400;0,600;0,700;0,800;1,400&family=Source+Code+Pro:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        :root {
            --primary-crimson: #B91C1C;
            --secondary-red: #DC2626;
            --light-crimson: #FEF2F2;
            --pale-crimson: #FDF2F2;
            --deep-crimson: #7F1D1D;
            --clinical-burgundy: #881337;
            --sophisticated-rose: #E11D48;
            --medical-gold: #F59E0B;
            --clinical-slate: #475569;
            --health-emerald: #059669;
            --charcoal: #374151;
            --steel: #64748B;
            --cream: #F9FAFB;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #FFF5F5 50%, var(--pale-crimson) 100%);
            color: var(--charcoal);
            line-height: 1.65;
            overflow-x: hidden;
            position: relative;
        }

        /* Advanced Diagnostic Flow Background */
        body::before {
            content: '';
            position: fixed;
            top: -100%;
            left: -100%;
            width: 300%;
            height: 300%;
            background: 
                radial-gradient(ellipse at 40% 20%, rgba(185, 28, 28, 0.09) 0%, transparent 80%),
                radial-gradient(ellipse at 60% 80%, rgba(225, 29, 72, 0.1) 0%, transparent 75%),
                radial-gradient(ellipse at 90% 5%, rgba(245, 158, 11, 0.07) 0%, transparent 70%),
                radial-gradient(ellipse at 10% 90%, rgba(71, 85, 105, 0.06) 0%, transparent 65%);
            animation: diagnosticFlow 76s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes diagnosticFlow {
            0%, 100% { 
                transform: rotate(0deg) scale(1) translate(0, 0); 
                opacity: 0.9; 
            }
            25% { 
                transform: rotate(90deg) scale(1.35) translate(65px, -35px); 
                opacity: 1; 
            }
            50% { 
                transform: rotate(180deg) scale(0.85) translate(-55px, 55px); 
                opacity: 0.95; 
            }
            75% { 
                transform: rotate(270deg) scale(1.3) translate(50px, -20px); 
                opacity: 0.98; 
            }
        }

        /* ROC Analysis Pattern */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(130deg, 
                    transparent 0px, 
                    rgba(185, 28, 28, 0.028) 1px, 
                    transparent 2px, 
                    transparent 120px),
                repeating-linear-gradient(-20deg, 
                    transparent 0px, 
                    rgba(225, 29, 72, 0.022) 1px, 
                    transparent 2px, 
                    transparent 140px);
            z-index: -1;
            animation: diagnosticGrid 60s linear infinite;
        }

        @keyframes diagnosticGrid {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(120px) translateY(140px); }
        }

        .container {
            max-width: 2200px;
            margin: 50px auto;
            background: rgba(255, 255, 255, 0.96);
            box-shadow: 
                0 0 125px rgba(185, 28, 28, 0.21),
                0 60px 115px rgba(225, 29, 72, 0.19),
                0 50px 75px rgba(245, 158, 11, 0.17);
            border-radius: 72px;
            overflow: hidden;
            backdrop-filter: blur(38px);
            animation: diagnosticEntry 5.0s cubic-bezier(0.23, 1, 0.32, 1);
            border: 1px solid rgba(185, 28, 28, 0.32);
        }

        @keyframes diagnosticEntry {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(125px) rotateX(38deg);
                filter: blur(38px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0) rotateX(0deg);
                filter: blur(0);
            }
        }

        /* Diagnostic Test Header Design */
        .header-section {
            background: linear-gradient(135deg, var(--charcoal) 0%, var(--primary-crimson) 35%, var(--deep-crimson) 70%, var(--clinical-burgundy) 100%);
            color: white;
            padding: 105px 95px;
            position: relative;
            overflow: hidden;
        }

        .header-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(110deg, 
                transparent 0%, 
                rgba(225, 29, 72, 0.3) 5%, 
                transparent 20%, 
                rgba(245, 158, 11, 0.25) 38%, 
                transparent 55%, 
                rgba(71, 85, 105, 0.22) 70%, 
                transparent 85%);
            animation: diagnosticHeader 30s ease-in-out infinite;
        }

        @keyframes diagnosticHeader {
            0%, 100% { 
                transform: translateX(-200px) scaleY(1) rotate(0deg); 
                opacity: 0.9; 
            }
            33% { 
                transform: translateX(145px) scaleY(1.85) rotate(3.5deg); 
                opacity: 1; 
            }
            66% { 
                transform: translateX(-115px) scaleY(0.7) rotate(-3deg); 
                opacity: 0.94; 
            }
        }

        .header-title {
            font-family: 'Playfair Display', serif;
            font-size: 7.5em;
            font-weight: 900;
            margin-bottom: 60px;
            text-shadow: 10px 12px 38px rgba(0,0,0,0.9);
            position: relative;
            z-index: 2;
            background: linear-gradient(135deg, white 0%, var(--light-crimson) 18%, #FFB3B3 50%, white 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleDiagnostic 7.6s ease-in-out infinite alternate;
            letter-spacing: -5.6px;
        }

        @keyframes titleDiagnostic {
            from { 
                filter: drop-shadow(0 0 45px rgba(225, 29, 72, 1.0)); 
                text-shadow: 0 0 95px rgba(185, 28, 28, 0.8);
            }
            to { 
                filter: drop-shadow(0 0 65px rgba(185, 28, 28, 1.0)); 
                text-shadow: 0 0 115px rgba(127, 29, 29, 0.9);
            }
        }

        .header-subtitle {
            font-size: 3.9em;
            font-weight: 400;
            opacity: 0.98;
            position: relative;
            z-index: 2;
            color: var(--light-crimson);
            text-shadow: 9px 10px 32px rgba(0,0,0,0.8);
            letter-spacing: 2.9px;
            font-style: italic;
        }

        /* Advanced Diagnostic Navigation */
        .nav-tabs {
            display: flex;
            background: linear-gradient(90deg, var(--primary-crimson) 0%, var(--medical-gold) 8%, var(--clinical-slate) 16%, var(--sophisticated-rose) 24%, var(--deep-crimson) 32%, var(--clinical-burgundy) 40%, var(--primary-crimson) 48%, var(--sophisticated-rose) 56%, var(--deep-crimson) 64%, var(--medical-gold) 72%, var(--primary-crimson) 80%, var(--clinical-burgundy) 88%, var(--primary-crimson) 100%);
            padding: 0;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 12px 0 rgba(225, 29, 72, 1.0);
        }

        .nav-tabs::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.28) 0%, 
                rgba(225, 29, 72, 0.45) 50%, 
                rgba(255,255,255,0.28) 100%);
            transform: translateX(-500%);
            animation: diagnosticNav 24s ease-in-out infinite;
        }

        @keyframes diagnosticNav {
            0%, 100% { transform: translateX(-500%); }
            50% { transform: translateX(1000%); }
        }

        .tab-button {
            flex: 1;
            padding: 65px 70px;
            background: none;
            border: none;
            color: white;
            font-weight: 500;
            font-size: 1.8em;
            cursor: pointer;
            transition: all 1.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-bottom: 13px solid transparent;
            position: relative;
            z-index: 2;
            letter-spacing: 2.1px;
        }

        .tab-button:hover {
            background: rgba(225, 29, 72, 0.45);
            transform: translateY(-9px);
            box-shadow: 0 28px 65px rgba(0,0,0,0.6);
            color: var(--cream);
        }

        .tab-button.active {
            background: rgba(225, 29, 72, 0.6);
            border-bottom-color: var(--medical-gold);
            font-weight: 600;
            color: var(--cream);
            box-shadow: inset 0 -13px 0 var(--medical-gold);
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 135px;
            animation: diagnosticSlide 2.8s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .content-section.active {
            display: block;
        }

        @keyframes diagnosticSlide {
            from {
                opacity: 0;
                transform: translateY(120px) scale(0.92);
                filter: blur(25px);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        /* Section Titles - RED (Consistency) */
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 7.5em;
            color: var(--secondary-red);
            margin-bottom: 125px;
            text-align: center;
            font-weight: 900;
            position: relative;
            text-shadow: 9px 10px 32px rgba(0,0,0,0.3);
            letter-spacing: -5.0px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -55px;
            left: 50%;
            transform: translateX(-50%);
            width: 500px;
            height: 12px;
            background: linear-gradient(90deg, 
                var(--light-crimson) 0%, 
                var(--medical-gold) 6%, 
                var(--clinical-slate) 12%, 
                var(--sophisticated-rose) 18%, 
                var(--deep-crimson) 24%, 
                var(--primary-crimson) 30%, 
                var(--clinical-burgundy) 36%, 
                var(--sophisticated-rose) 42%, 
                var(--deep-crimson) 48%, 
                var(--medical-gold) 54%, 
                var(--clinical-slate) 60%, 
                var(--light-crimson) 100%);
            border-radius: 11px;
            animation: diagnosticUnderline 12.0s ease-in-out infinite alternate;
        }

        @keyframes diagnosticUnderline {
            from { width: 500px; opacity: 0.9; }
            to { width: 700px; opacity: 1; }
        }

        /* Medical Crimson/Burgundy Boxes - Advanced Framework */
        .theory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(750px, 1fr));
            gap: 115px;
            margin-bottom: 135px;
        }

        .theory-card {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, #FFF5F5 50%, var(--white) 100%);
            padding: 95px;
            border-radius: 60px;
            border: 11px solid var(--light-crimson);
            box-shadow: 
                0 55px 145px rgba(185, 28, 28, 0.24),
                0 35px 70px rgba(225, 29, 72, 0.26);
            transition: all 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .theory-card::before {
            content: '';
            position: absolute;
            top: -80px;
            right: -80px;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, 
                rgba(225, 29, 72, 0.24) 0%, 
                rgba(185, 28, 28, 0.22) 40%, 
                transparent 70%);
            border-radius: 50%;
            animation: cardDiagnostic 16s ease-in-out infinite;
        }

        @keyframes cardDiagnostic {
            0%, 100% { 
                transform: scale(1) translateX(0) translateY(0) rotate(0deg); 
                opacity: 0.94; 
            }
            25% { 
                transform: scale(1.5) translateX(60px) translateY(-60px) rotate(90deg); 
                opacity: 1; 
            }
            50% { 
                transform: scale(0.7) translateX(-50px) translateY(50px) rotate(180deg); 
                opacity: 0.9; 
            }
            75% { 
                transform: scale(1.45) translateX(50px) translateY(-30px) rotate(270deg); 
                opacity: 1; 
            }
        }

        .theory-card:hover {
            transform: translateY(-38px);
            box-shadow: 
                0 70px 190px rgba(185, 28, 28, 0.32),
                0 45px 95px rgba(225, 29, 72, 0.4);
            border-color: var(--primary-crimson);
        }

        .theory-card h3 {
            font-family: 'Playfair Display', serif;
            color: var(--secondary-red);
            margin-bottom: 65px;
            font-size: 4.1em;
            font-weight: 700;
            position: relative;
            z-index: 2;
            letter-spacing: -2.4px;
        }

        .theory-card p {
            font-size: 1.9em;
            line-height: 2.5;
            margin-bottom: 38px;
            position: relative;
            z-index: 2;
            font-weight: 400;
        }

        /* Mathematical Formulas - Diagnostic Style */
        .formula-display {
            background: linear-gradient(135deg, var(--charcoal) 0%, var(--primary-crimson) 50%, var(--deep-crimson) 100%);
            color: white;
            padding: 80px;
            border-radius: 55px;
            margin: 70px 0;
            font-family: 'Source Code Pro', monospace;
            font-size: 1.9em;
            box-shadow: 
                inset 0 11px 60px rgba(0,0,0,0.95), 
                0 50px 105px rgba(185, 28, 28, 0.65);
            overflow-x: auto;
            border: 11px solid rgba(225, 29, 72, 1.0);
            position: relative;
        }

        .formula-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 11px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--light-crimson) 6%, 
                var(--medical-gold) 12%, 
                var(--clinical-slate) 18%, 
                var(--sophisticated-rose) 24%, 
                var(--deep-crimson) 30%, 
                var(--clinical-burgundy) 36%, 
                var(--sophisticated-rose) 42%, 
                transparent 100%);
            animation: formulaDiagnostic 8.5s ease-in-out infinite;
        }

        @keyframes formulaDiagnostic {
            0%, 100% { opacity: 0.8; transform: scaleX(0.7); }
            50% { opacity: 1; transform: scaleX(3.0); }
        }

        /* Medical Crimson Control Panel */
        .control-panel {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, #FFF5F5 50%, var(--white) 100%);
            padding: 125px;
            border-radius: 70px;
            margin: 125px 0;
            border: 12px solid var(--light-crimson);
            box-shadow: 
                0 65px 185px rgba(225, 29, 72, 0.38),
                inset 0 1px 0 rgba(255,255,255,0.99);
            position: relative;
            overflow: hidden;
        }

        .control-panel::before {
            content: '';
            position: absolute;
            top: -210%;
            left: -210%;
            width: 520%;
            height: 520%;
            background: conic-gradient(from 135deg at 50% 50%, 
                transparent 0%, 
                rgba(225, 29, 72, 0.14) 14%, 
                transparent 24%, 
                rgba(185, 28, 28, 0.12) 50%, 
                transparent 60%);
            animation: controlDiagnostic 48s linear infinite;
        }

        @keyframes controlDiagnostic {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .control-header {
            font-family: 'Playfair Display', serif;
            color: var(--secondary-red);
            font-size: 6.0em;
            margin-bottom: 105px;
            text-align: center;
            font-weight: 700;
            position: relative;
            z-index: 2;
            letter-spacing: -2.4px;
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(660px, 1fr));
            gap: 80px;
            margin-bottom: 115px;
            position: relative;
            z-index: 2;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 50px;
            color: var(--charcoal);
            font-size: 1.8em;
            letter-spacing: 1.1px;
        }

        .form-group select,
        .form-group input {
            padding: 55px;
            border: 2px solid #E5E7EB;
            border-radius: 50px;
            font-size: 1.7em;
            transition: all 1.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 18px 50px rgba(0,0,0,0.16);
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: var(--primary-crimson);
            box-shadow: 
                0 0 65px rgba(185, 28, 28, 0.65),
                0 0 0 11px rgba(225, 29, 72, 0.38);
            transform: translateY(-9px) scale(1.1);
        }

        /* Advanced Diagnostic Action Buttons */
        .button-group {
            display: flex;
            gap: 65px;
            margin-top: 115px;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        .btn {
            padding: 56px 125px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.9em;
            cursor: pointer;
            transition: all 1.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 4.2px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255,255,255,1.0) 50%, 
                transparent 100%);
            transition: left 2.2s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-crimson) 0%, var(--deep-crimson) 100%);
            color: white;
            box-shadow: 0 28px 85px rgba(185, 28, 28, 0.75);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--deep-crimson) 0%, var(--primary-crimson) 100%);
            transform: translateY(-20px);
            box-shadow: 0 45px 125px rgba(185, 28, 28, 0.85);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--medical-gold) 0%, #D97706 100%);
            color: white;
            box-shadow: 0 28px 85px rgba(245, 158, 11, 0.75);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #D97706 0%, var(--medical-gold) 100%);
            transform: translateY(-20px);
            box-shadow: 0 45px 125px rgba(245, 158, 11, 0.85);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--clinical-slate) 0%, #334155 100%);
            color: white;
            box-shadow: 0 28px 85px rgba(71, 85, 105, 0.75);
        }

        .btn-accent:hover {
            background: linear-gradient(135deg, #334155 0%, var(--clinical-slate) 100%);
            transform: translateY(-20px);
            box-shadow: 0 45px 125px rgba(71, 85, 105, 0.85);
        }

        /* Medical Crimson Results Container */
        .results-container {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, #FFF5F5 100%);
            border: 12px solid var(--light-crimson);
            border-radius: 67px;
            padding: 125px;
            margin: 125px 0;
            box-shadow: 
                0 65px 200px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.99);
            position: relative;
            overflow: hidden;
        }

        .results-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 13px;
            background: linear-gradient(90deg, 
                var(--light-crimson) 0%, 
                var(--medical-gold) 5%, 
                var(--clinical-slate) 10%, 
                var(--sophisticated-rose) 15%, 
                var(--deep-crimson) 20%, 
                var(--primary-crimson) 25%, 
                var(--clinical-burgundy) 30%, 
                var(--sophisticated-rose) 35%, 
                var(--deep-crimson) 40%, 
                var(--medical-gold) 45%, 
                var(--clinical-slate) 50%, 
                var(--primary-crimson) 55%, 
                var(--light-crimson) 100%);
            animation: diagnosticResults 8.5s ease-in-out infinite;
        }

        @keyframes diagnosticResults {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 1; }
        }

        .results-header {
            font-family: 'Playfair Display', serif;
            font-size: 6.5em;
            color: var(--secondary-red);
            margin-bottom: 105px;
            text-align: center;
            font-weight: 700;
            letter-spacing: -2.4px;
        }

        /* Medical Crimson Chart Container */
        .chart-container {
            position: relative;
            height: 1050px;
            margin: 125px 0;
            background: linear-gradient(135deg, var(--pale-crimson) 0%, var(--white) 100%);
            border-radius: 60px;
            padding: 115px;
            box-shadow: 0 55px 160px rgba(0,0,0,0.3);
            border: 11px solid var(--light-crimson);
        }

        /* Statistics Grid - Medical Crimson Theme */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(580px, 1fr));
            gap: 105px;
            margin: 118px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, var(--white) 100%);
            padding: 80px;
            border-radius: 55px;
            text-align: center;
            border: 11px solid var(--light-crimson);
            transition: all 1.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 11px;
            background: linear-gradient(90deg, var(--light-crimson) 0%, var(--primary-crimson) 50%, var(--medical-gold) 100%);
            transform: scaleX(0);
            transition: transform 1.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-30px) scale(1.11);
            box-shadow: 0 60px 165px rgba(0,0,0,0.38);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-value {
            font-family: 'Source Code Pro', monospace;
            font-size: 4.6em;
            font-weight: 700;
            color: var(--primary-crimson);
            margin-bottom: 38px;
        }

        .stat-label {
            font-size: 1.8em;
            color: var(--steel);
            font-weight: 500;
        }

        /* Diagnostic-Specific Elements */
        .diagnostic-info {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, #F0F8FF 100%);
            border: 11px solid var(--light-crimson);
            border-radius: 50px;
            padding: 80px;
            margin: 80px 0;
        }

        .diagnostic-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(460px, 1fr));
            gap: 55px;
            margin: 65px 0;
        }

        .diagnostic-metric-card {
            background: var(--primary-crimson);
            color: white;
            padding: 55px 45px;
            border-radius: 38px;
            text-align: center;
            font-family: 'Source Code Pro', monospace;
            font-size: 1.7em;
            font-weight: 600;
        }

        .diagnostic-metric-card:nth-child(1) { background: var(--medical-gold); }
        .diagnostic-metric-card:nth-child(2) { background: var(--clinical-slate); }
        .diagnostic-metric-card:nth-child(3) { background: var(--primary-crimson); }
        .diagnostic-metric-card:nth-child(4) { background: var(--sophisticated-rose); }

        /* Decision Framework - Medical Crimson */
        .decision-panel {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, rgba(225, 29, 72, 0.5) 100%);
            border: 12px solid var(--light-crimson);
            border-radius: 65px;
            padding: 115px;
            margin: 115px 0;
        }

        .decision-question {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            font-size: 2.9em;
            margin-bottom: 85px;
            color: var(--charcoal);
            text-align: center;
            letter-spacing: -1.1px;
        }

        .decision-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(620px, 1fr));
            gap: 65px;
        }

        .decision-option {
            padding: 65px;
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 50px;
            cursor: pointer;
            transition: all 1.3s ease;
            text-align: center;
            font-weight: 500;
            font-size: 1.8em;
        }

        .decision-option:hover {
            border-color: var(--medical-gold);
            background: var(--pale-crimson);
            transform: translateY(-18px);
        }

        .decision-option.selected {
            border-color: var(--primary-crimson);
            background: var(--pale-crimson);
            box-shadow: 0 0 90px rgba(185, 28, 28, 0.75);
        }

        /* Feedback Messages */
        .feedback-message {
            padding: 80px;
            border-radius: 55px;
            margin: 80px 0;
            font-weight: 500;
            font-size: 1.9em;
        }

        .feedback-success {
            background: var(--pale-crimson);
            border: 11px solid var(--light-crimson);
            color: var(--deep-crimson);
        }

        .feedback-warning {
            background: #FFF8E1;
            border: 11px solid var(--medical-gold);
            color: #8F6300;
        }

        .feedback-danger {
            background: #FFEBEE;
            border: 11px solid #DC2626;
            color: #8B0000;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin: 55px;
                border-radius: 67px;
            }

            .header-title {
                font-size: 6.5em;
            }

            .theory-grid {
                grid-template-columns: 1fr;
            }

            .control-group {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .button-group {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .diagnostic-metrics {
                grid-template-columns: 1fr;
            }
        }

        /* Research References - Medical Crimson */
        .research-note {
            background: linear-gradient(135deg, var(--pale-crimson) 0%, #F0F8FF 100%);
            padding: 80px;
            border-radius: 50px;
            margin: 80px 0;
            border-left: 24px solid var(--primary-crimson);
            font-style: italic;
            position: relative;
        }

        .research-note::before {
            content: 'ü©∫';
            position: absolute;
            top: 80px;
            left: 65px;
            font-size: 3.0em;
        }

        .research-note p {
            margin-left: 115px;
            line-height: 2.6;
        }

        /* Advanced Visual Effects */
        .diagnostic-highlight {
            background: rgba(185, 28, 28, 0.27);
            border-left: 20px solid var(--primary-crimson);
            padding: 55px;
            margin: 55px 0;
            border-radius: 28px;
        }

        .roc-auc-display {
            display: inline-block;
            background: linear-gradient(135deg, var(--light-crimson) 0%, var(--primary-crimson) 100%);
            color: white;
            padding: 28px 55px;
            border-radius: 60px;
            font-family: 'Source Code Pro', monospace;
            font-weight: 700;
            margin: 0 28px;
            font-size: 1.7em;
        }

        /* Canadian Healthcare Context */
        .canada-diagnostic {
            background: linear-gradient(135deg, #FF6B6B 0%, #DC2626 100%);
            color: white;
            padding: 24px 50px;
            border-radius: 50px;
            font-family: 'Source Code Pro', monospace;
            font-weight: 600;
            font-size: 1.2em;
            display: inline-block;
            margin: 0 24px;
        }

        /* ROC Curve Visualization */
        .roc-curve-info {
            display: flex;
            justify-content: space-between;
            background: var(--pale-crimson);
            padding: 60px;
            border-radius: 38px;
            margin: 60px 0;
        }

        .roc-metric {
            background: var(--primary-crimson);
            color: white;
            padding: 38px 55px;
            border-radius: 28px;
            text-align: center;
            flex: 1;
            margin: 0 24px;
            font-family: 'Source Code Pro', monospace;
            font-weight: 600;
            font-size: 1.6em;
        }

        .roc-metric:first-child {
            background: var(--medical-gold);
        }

        .roc-metric:nth-child(2) {
            background: var(--clinical-slate);
        }

        .roc-metric:last-child {
            background: var(--sophisticated-rose);
        }

        /* Diagnostic Steps */
        .diagnostic-steps {
            background: var(--pale-crimson);
            padding: 65px;
            border-radius: 43px;
            margin: 65px 0;
            border: 10px solid var(--light-crimson);
        }

        .step-item {
            display: flex;
            align-items: center;
            margin: 38px 0;
            padding: 38px;
            background: white;
            border-radius: 25px;
            box-shadow: 0 16px 38px rgba(0,0,0,0.16);
        }

        .step-number {
            background: var(--primary-crimson);
            color: white;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 38px;
            font-family: 'Source Code Pro', monospace;
        }

        .step-text {
            font-weight: 500;
            color: var(--charcoal);
        }

        /* Confusion Matrix */
        .confusion-matrix {
            background: white;
            border-radius: 30px;
            padding: 55px;
            margin: 55px 0;
            box-shadow: 0 22px 55px rgba(0,0,0,0.22);
            border: 4px solid var(--light-crimson);
        }

        .confusion-matrix table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Source Code Pro', monospace;
            font-size: 1.5em;
        }

        .confusion-matrix th,
        .confusion-matrix td {
            padding: 22px;
            text-align: center;
            border: 2px solid var(--light-crimson);
        }

        .confusion-matrix th {
            background: var(--primary-crimson);
            color: white;
            font-weight: 700;
        }

        .confusion-matrix .true-pos {
            background: rgba(5, 150, 105, 0.15);
        }

        .confusion-matrix .false-pos {
            background: rgba(245, 158, 11, 0.15);
        }

        .confusion-matrix .false-neg {
            background: rgba(185, 28, 28, 0.15);
        }

        .confusion-matrix .true-neg {
            background: rgba(71, 85, 105, 0.15);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header-section">
            <h1 class="header-title">Diagnostic Test Evaluation in Healthcare & ROC Analysis</h1>
            <p class="header-subtitle">Advanced Series: Precision Methods for Clinical Test Assessment</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="tab-button active" onclick="showSection('theory')">ü©∫ Diagnostic Theory</button>
            <button class="tab-button" onclick="showSection('simulation')">üá®üá¶ Test Evaluation</button>
            <button class="tab-button" onclick="showSection('analysis')">üîç ROC Analysis</button>
            <button class="tab-button" onclick="showSection('assessment')">‚úÖ Assessment Mode</button>
        </div>

        <!-- Theory Framework Section -->
        <div id="theory" class="content-section active">
            <h2 class="section-title">Diagnostic Test Evaluation Framework for Healthcare</h2>
            
            <div class="theory-grid">
                <div class="theory-card">
                    <h3>ü©∫ ROC Curve Analysis</h3>
                    <p><strong>Receiver Operating Characteristic:</strong> ROC curves plot sensitivity versus 1-specificity across all threshold values, providing comprehensive visualization of test performance and optimal cutpoint selection for clinical decision-making.</p>
                    <div class="formula-display">
                        ROC Curve Construction:<br><br>
                        Sensitivity = TP/(TP + FN)<br>
                        Specificity = TN/(TN + FP)<br>
                        1-Specificity = FP/(FP + TN)<br><br>
                        Area Under Curve (AUC):<br>
                        AUC = ‚à´‚ÇÄ¬π Sensitivity(t) d(1-Specificity(t))<br><br>
                        Interpretation:<br>
                        AUC = 0.5: No diagnostic value (random)<br>
                        AUC = 0.6-0.7: Poor diagnostic accuracy<br>
                        AUC = 0.7-0.8: Acceptable accuracy<br>
                        AUC = 0.8-0.9: Excellent accuracy<br>
                        AUC = 0.9-1.0: Outstanding accuracy<br><br>
                        Youden Index: J = Sensitivity + Specificity - 1<br>
                        Optimal cutpoint maximizes J
                    </div>
                    <p><em>Clinical insight: Essential for establishing diagnostic thresholds and comparing test performance across different biomarkers</em></p>
                </div>

                <div class="theory-card">
                    <h3>‚öñÔ∏è Sensitivity & Specificity</h3>
                    <p><strong>Fundamental Test Characteristics:</strong> Sensitivity measures the test's ability to correctly identify disease presence, while specificity measures correct identification of disease absence, fundamental for understanding test performance.</p>
                    <div class="formula-display">
                        Test Performance Measures:<br><br>
                        Sensitivity (True Positive Rate):<br>
                        Se = TP/(TP + FN)<br>
                        Probability of positive test given disease present<br><br>
                        Specificity (True Negative Rate):<br>
                        Sp = TN/(TN + FP)<br>
                        Probability of negative test given disease absent<br><br>
                        Trade-offs:<br>
                        ‚Üë Sensitivity ‚Üí ‚Üì Specificity (usually)<br>
                        ‚Üë Threshold ‚Üí ‚Üë Specificity, ‚Üì Sensitivity<br>
                        ‚Üì Threshold ‚Üí ‚Üë Sensitivity, ‚Üì Specificity<br><br>
                        Clinical Context:<br>
                        High Se needed: screening, early detection<br>
                        High Sp needed: confirmation, avoid false alarms
                    </div>
                    <p><strong>Medical Example:</strong> Cancer screening prioritizes high sensitivity to avoid missing cases, while confirmation testing emphasizes high specificity</p>
                </div>

                <div class="theory-card">
                    <h3>üéØ Predictive Values</h3>
                    <p><strong>Clinical Utility Measures:</strong> Positive and negative predictive values quantify the probability of disease given test results, directly relevant for patient counseling and clinical decision-making in practice.</p>
                    <div class="formula-display">
                        Predictive Values:<br><br>
                        Positive Predictive Value (PPV):<br>
                        PPV = TP/(TP + FP)<br>
                        P(Disease | Test Positive)<br><br>
                        Negative Predictive Value (NPV):<br>
                        NPV = TN/(TN + FN)<br>
                        P(No Disease | Test Negative)<br><br>
                        Prevalence Dependence:<br>
                        PPV = (Se √ó Prev)/[(Se √ó Prev) + ((1-Sp) √ó (1-Prev))]<br>
                        NPV = (Sp √ó (1-Prev))/[((1-Se) √ó Prev) + (Sp √ó (1-Prev))]<br><br>
                        Key Insight: PPV ‚Üë as prevalence ‚Üë<br>
                                    NPV ‚Üë as prevalence ‚Üì<br><br>
                        Clinical Application: Direct interpretation for patient care
                    </div>
                    <p><strong>Clinical Application:</strong> PPV tells patients the probability they have disease given a positive test, accounting for disease prevalence in their population</p>
                </div>

                <div class="theory-card">
                    <h3>üìà Likelihood Ratios</h3>
                    <p><strong>Evidence Strength Quantification:</strong> Likelihood ratios quantify how much test results change disease probability, providing intuitive measures of diagnostic evidence strength independent of prevalence.</p>
                    <div class="formula-display">
                        Likelihood Ratios:<br><br>
                        Positive Likelihood Ratio (LR+):<br>
                        LR+ = Sensitivity/(1 - Specificity)<br>
                        LR+ = P(Test+ | Disease)/P(Test+ | No Disease)<br><br>
                        Negative Likelihood Ratio (LR-):<br>
                        LR- = (1 - Sensitivity)/Specificity<br>
                        LR- = P(Test- | Disease)/P(Test- | No Disease)<br><br>
                        Clinical Interpretation:<br>
                        LR+ > 10: Strong evidence for disease<br>
                        LR+ 5-10: Moderate evidence for disease<br>
                        LR+ 2-5: Weak evidence for disease<br>
                        LR+ 1: No diagnostic value<br><br>
                        LR- < 0.1: Strong evidence against disease<br>
                        LR- 0.1-0.2: Moderate evidence against<br>
                        LR- 0.2-0.5: Weak evidence against<br><br>
                        Prevalence Independence: Major advantage over PPV/NPV
                    </div>
                    <p><strong>Medical Use:</strong> LR+ = 5 means positive test is 5 times more likely in diseased than non-diseased patients</p>
                </div>

                <div class="theory-card">
                    <h3>üîç Diagnostic Odds Ratio</h3>
                    <p><strong>Overall Test Performance:</strong> Diagnostic odds ratio combines sensitivity and specificity into a single measure of test discriminative ability, useful for meta-analysis and comprehensive test evaluation.</p>
                    <div class="formula-display">
                        Diagnostic Odds Ratio (DOR):<br><br>
                        DOR = (TP √ó TN)/(FP √ó FN)<br><br>
                        Alternative Expression:<br>
                        DOR = LR+ / LR-<br>
                        DOR = [Se/(1-Se)] / [(1-Sp)/Sp]<br><br>
                        Interpretation:<br>
                        DOR = 1: No diagnostic ability<br>
                        DOR > 1: Test has diagnostic value<br>
                        DOR ‚Üí ‚àû: Perfect diagnostic test<br><br>
                        Practical Values:<br>
                        DOR < 3: Poor diagnostic performance<br>
                        DOR 3-15: Acceptable performance<br>
                        DOR > 15: Good diagnostic performance<br><br>
                        Meta-Analysis: Ideal for pooling diagnostic studies<br>
                        Independence: Not affected by prevalence
                    </div>
                    <p><strong>Clinical Example:</strong> DOR = 20 indicates test results are 20 times more likely to be correct than incorrect</p>
                </div>

                <div class="theory-card">
                    <h3>üé≤ Multi-Class ROC Analysis</h3>
                    <p><strong>Multiple Category Diagnostics:</strong> Multi-class ROC extends binary diagnostic evaluation to situations with multiple disease categories or severity levels, essential for complex diagnostic scenarios.</p>
                    <div class="formula-display">
                        Multi-Class ROC Approaches:<br><br>
                        One-vs-Rest (OvR):<br>
                        For each class i:<br>
                        AUC_i = ROC(Class_i vs All_Others)<br><br>
                        Macro-Average AUC:<br>
                        AUC_macro = (1/k) √ó Œ£ AUC_i<br><br>
                        One-vs-One (OvO):<br>
                        For each pair (i,j):<br>
                        AUC_ij = ROC(Class_i vs Class_j)<br><br>
                        Volume Under Surface (VUS):<br>
                        Extension of AUC to 3+ classes<br>
                        VUS ‚àà [1/k!, 1] where k = number of classes<br><br>
                        Hand-Till Method:<br>
                        Unbiased multi-class AUC estimation<br>
                        AUC_HT = (2/k(k-1)) √ó Œ£_i<j AUC(i,j)
                    </div>
                    <p><strong>Medical Application:</strong> Diagnostic classification of disease severity (mild, moderate, severe) or multiple competing diagnoses</p>
                </div>
            </div>

            <div class="theory-card" style="grid-column: 1 / -1;">
                <h3>üá®üá¶ Canadian Advanced Diagnostic Test Applications</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 80px; margin-top: 70px;">
                    <div>
                        <h4>üè• Clinical Diagnostic Applications:</h4>
                        <ul>
                            <li><strong>Cancer Screening Evaluation:</strong> Mammography sensitivity/specificity across age groups and risk factors</li>
                            <li><strong>Cardiac Biomarker Assessment:</strong> Troponin and BNP diagnostic accuracy for acute coronary syndromes</li>
                            <li><strong>Infectious Disease Testing:</strong> COVID-19, tuberculosis, and HIV test validation studies</li>
                            <li><strong>Laboratory Test Validation:</strong> Clinical chemistry reference range establishment and performance</li>
                        </ul>
                    </div>
                    <div>
                        <h4>üìä Health Technology Assessment:</h4>
                        <ul>
                            <li><strong>Medical Imaging Analysis:</strong> CT, MRI, and ultrasound diagnostic performance evaluation</li>
                            <li><strong>Point-of-Care Testing:</strong> Rapid diagnostic test validation for emergency and rural settings</li>
                            <li><strong>Screening Program Optimization:</strong> Population-based screening threshold optimization</li>
                            <li><strong>Health Economic Evaluation:</strong> Cost-effectiveness of diagnostic strategies and protocols</li>
                        </ul>
                    </div>
                </div>

                <div class="diagnostic-steps" style="margin-top: 70px;">
                    <h4 style="color: var(--secondary-red); margin-bottom: 55px; text-align: center;">ü©∫ Diagnostic Test Evaluation Process</h4>
                    <div class="step-item">
                        <div class="step-number">1</div>
                        <div class="step-text"><strong>Study Design:</strong> Define gold standard, study population, and test conditions</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">2</div>
                        <div class="step-text"><strong>Data Collection:</strong> Obtain test results and reference standard outcomes</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">3</div>
                        <div class="step-text"><strong>Confusion Matrix:</strong> Construct 2√ó2 table with true/false positives and negatives</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">4</div>
                        <div class="step-text"><strong>Performance Metrics:</strong> Calculate sensitivity, specificity, and predictive values</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">5</div>
                        <div class="step-text"><strong>ROC Analysis:</strong> Generate ROC curve and calculate area under curve</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">6</div>
                        <div class="step-text"><strong>Threshold Selection:</strong> Optimize cutpoint based on clinical consequences</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">7</div>
                        <div class="step-text"><strong>Clinical Translation:</strong> Implement findings in practice guidelines and protocols</div>
                    </div>
                </div>
            </div>

            <div class="research-note">
                <p><strong>ü©∫ Advanced Diagnostic Test Evaluation Foundation:</strong> Diagnostic test evaluation provides essential methodology for assessing clinical test performance, from basic sensitivity and specificity to sophisticated ROC analysis and multi-class diagnostics. Understanding test characteristics, prevalence effects, and clinical utility measures is crucial for evidence-based medicine, health technology assessment, and clinical decision-making. These rigorous methods enable optimal test selection, threshold establishment, and diagnostic protocol development across diverse healthcare applications.</p>
            </div>
        </div>

        <!-- Canadian Test Evaluation Section -->
        <div id="simulation" class="content-section">
            <h2 class="section-title">Canadian Diagnostic Test Evaluation Laboratory</h2>

            <div class="control-panel">
                <h3 class="control-header">ü©∫ Diagnostic Test Simulator</h3>
                
                <div class="control-group">
                    <div class="form-group">
                        <label for="diagnosticModel">Canadian Medical Diagnostic Model</label>
                        <select id="diagnosticModel" onchange="updateDiagnosticModel()">
                            <option value="cancer_screening">Cancer Screening Evaluation</option>
                            <option value="cardiac_biomarkers">Cardiac Biomarker Assessment</option>
                            <option value="infectious_testing">Infectious Disease Testing</option>
                            <option value="medical_imaging">Medical Imaging Analysis</option>
                            <option value="laboratory_validation">Laboratory Test Validation</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="analysisType">Diagnostic Analysis Method</label>
                        <select id="analysisType">
                            <option value="roc_analysis" selected>ROC Curve Analysis</option>
                            <option value="performance_metrics">Performance Metrics</option>
                            <option value="threshold_optimization">Threshold Optimization</option>
                            <option value="multiclass_roc">Multi-Class ROC</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="diseasePrevalence">Disease Prevalence (%)</label>
                        <select id="diseasePrevalence">
                            <option value="5">5% (Low prevalence)</option>
                            <option value="15" selected>15% (Moderate prevalence)</option>
                            <option value="35">35% (High prevalence)</option>
                            <option value="50">50% (Balanced design)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="sampleSizeDiagnostic">Study Population Size</label>
                        <select id="sampleSizeDiagnostic">
                            <option value="200">200 participants</option>
                            <option value="500" selected>500 participants</option>
                            <option value="1000">1,000 participants</option>
                            <option value="2000">2,000 participants</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="testAccuracy">Test Accuracy (AUC)</label>
                        <input type="range" id="testAccuracy" min="0.5" max="0.95" step="0.05" value="0.8" onchange="updateAccuracyDisplay()">
                        <span id="accuracyValue">0.80</span> (Excellent accuracy)
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="generateDiagnosticData()">ü©∫ Generate Data</button>
                    <button class="btn btn-secondary" onclick="performDiagnosticAnalysis()">üîç Run Analysis</button>
                    <button class="btn btn-accent" onclick="performROCModeling()">üìà ROC Modeling</button>
                </div>
            </div>

            <!-- Medical Model Description -->
            <div id="diagnosticDescription" class="diagnostic-info">
                <div class="results-header">Current Diagnostic Test Model</div>
                <div id="diagnosticText"></div>
                <div id="diagnosticModelMetrics" class="diagnostic-metrics"></div>
            </div>

            <!-- Diagnostic Analysis Chart -->
            <div class="chart-container">
                <canvas id="diagnosticChart"></canvas>
            </div>
        </div>

        <!-- ROC Analysis Section -->
        <div id="analysis" class="content-section">
            <h2 class="section-title">Diagnostic Analysis & Results</h2>

            <div id="diagnosticResults" class="results-container">
                <div class="results-header">Diagnostic Test Results</div>
                <div id="diagnosticTable"></div>
            </div>

            <div class="stats-grid" id="diagnosticStats">
                <!-- Dynamic statistics will be populated here -->
            </div>

            <div id="rocResults" class="results-container">
                <div class="results-header">ü©∫ ROC Analysis & Test Performance</div>
                <div id="rocTable"></div>
            </div>

            <!-- ROC Curve Visualization -->
            <div class="chart-container">
                <h3 style="text-align: center; margin-bottom: 70px; color: var(--secondary-red);">üîç ROC Curve & Diagnostic Performance Analysis</h3>
                <canvas id="rocChart"></canvas>
            </div>
        </div>

        <!-- Assessment Mode Section -->
        <div id="assessment" class="content-section">
            <h2 class="section-title">Diagnostic Test Assessment</h2>

            <div id="assessmentQuestion" class="decision-panel">
                <div class="decision-question">Loading diagnostic test assessment...</div>
                <div class="decision-options" id="assessmentOptions">
                    <!-- Dynamic options will be populated -->
                </div>
                <button class="btn btn-primary" onclick="checkAnswer()" style="margin-top: 80px;">Submit Answer</button>
            </div>

            <div id="assessmentFeedback"></div>

            <div class="button-group" style="margin-top: 115px;">
                <button class="btn btn-secondary" onclick="generateNewQuestion()">üìù New Question</button>
                <button class="btn btn-accent" onclick="showExpertSolution()">üéì Show Analysis</button>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentDiagnosticModel = null;
        let currentDiagnosticChart = null;
        let rocChart = null;
        let selectedAnswer = null;
        let currentQuestion = null;

        // Medical Diagnostic Model Definitions
        const diagnosticModels = {
            cancer_screening: {
                title: "Cancer Screening Evaluation (Mammography Performance Assessment)",
                description: "Multi-center diagnostic accuracy study evaluating digital mammography performance for breast cancer detection across different age groups, breast density categories, and risk factor profiles in Canadian screening programs.",
                test: "Digital Mammography BI-RADS Score",
                condition: "Breast Cancer (Invasive + DCIS)",
                population: "Women aged 40-74 participating in organized screening programs",
                clinical_context: "Population-based cancer screening and early detection programs",
                study_design: "Cross-sectional diagnostic accuracy study with histological confirmation",
                expected_performance: "Sensitivity 80-85%, Specificity 90-95%, AUC 0.85-0.90",
                clinical_application: "Screening protocols, recall thresholds, risk stratification, quality assurance"
            },
            cardiac_biomarkers: {
                title: "Cardiac Biomarker Assessment (Troponin Diagnostic Accuracy)",
                description: "Emergency department validation study assessing high-sensitivity cardiac troponin performance for acute myocardial infarction diagnosis, comparing multiple biomarkers and serial measurement strategies.",
                test: "High-Sensitivity Cardiac Troponin I (ng/L)",
                condition: "Acute Myocardial Infarction (STEMI + NSTEMI)",
                population: "Adult patients presenting with chest pain to emergency departments",
                clinical_context: "Acute cardiac care and emergency medicine diagnosis",
                study_design: "Prospective diagnostic cohort with 30-day clinical follow-up",
                expected_performance: "Sensitivity 95-99%, Specificity 85-90%, AUC 0.92-0.96",
                clinical_application: "Emergency protocols, rule-out strategies, serial testing, discharge decisions"
            },
            infectious_testing: {
                title: "Infectious Disease Testing (COVID-19 Rapid Antigen Validation)",
                description: "Multi-site validation study comparing rapid antigen test performance to RT-PCR for COVID-19 diagnosis across symptomatic and asymptomatic populations in various healthcare and community settings.",
                test: "Rapid Antigen Test (Lateral Flow)",
                condition: "SARS-CoV-2 Infection (Active)",
                population: "Symptomatic and asymptomatic individuals across healthcare settings",
                clinical_context: "Infectious disease control and public health response",
                study_design: "Comparative diagnostic accuracy study with RT-PCR gold standard",
                expected_performance: "Sensitivity 70-85%, Specificity 95-99%, AUC 0.82-0.88",
                clinical_application: "Testing strategies, isolation protocols, outbreak investigation, contact tracing"
            },
            medical_imaging: {
                title: "Medical Imaging Analysis (CT Pulmonary Embolism Detection)",
                description: "Radiologist performance evaluation study assessing CT pulmonary angiography diagnostic accuracy for pulmonary embolism detection, including inter-reader variability and AI-assisted interpretation.",
                test: "CT Pulmonary Angiography (CTPA) Interpretation",
                condition: "Pulmonary Embolism (Acute)",
                population: "Adult patients with suspected pulmonary embolism",
                clinical_context: "Emergency radiology and thromboembolism diagnosis",
                study_design: "Multi-reader multi-case study with expert consensus reference standard",
                expected_performance: "Sensitivity 85-95%, Specificity 90-95%, AUC 0.88-0.93",
                clinical_application: "Imaging protocols, reader training, AI integration, quality improvement"
            },
            laboratory_validation: {
                title: "Laboratory Test Validation (HbA1c Point-of-Care Testing)",
                description: "Clinical chemistry validation study comparing point-of-care HbA1c analyzers to laboratory reference methods across diverse patient populations and diabetes management settings.",
                test: "Point-of-Care HbA1c Analyzer (%)",
                condition: "Diabetes Diagnosis and Management Thresholds",
                population: "Adult patients in primary care and diabetes clinics",
                clinical_context: "Laboratory medicine and diabetes care quality improvement",
                study_design: "Method comparison study with reference laboratory standard",
                expected_performance: "Sensitivity 90-95%, Specificity 85-92%, AUC 0.87-0.92",
                clinical_application: "Point-of-care testing protocols, diabetes diagnosis, treatment monitoring"
            }
        };

        // Assessment Questions (Diagnostic Test focused)
        const assessmentQuestions = [
            {
                question: "What does an ROC curve with AUC = 0.5 indicate about a diagnostic test?",
                options: [
                    "The test has perfect diagnostic accuracy",
                    "The test performs no better than random chance",
                    "The test has 50% sensitivity and 50% specificity",
                    "The test is only useful in 50% of cases"
                ],
                correct: 1,
                explanation: "An AUC of 0.5 indicates that the test performs no better than random chance - the ROC curve follows the diagonal line of no discrimination. This means the test provides no diagnostic information to distinguish between diseased and non-diseased individuals."
            },
            {
                question: "How does disease prevalence affect positive predictive value (PPV)?",
                options: [
                    "Prevalence has no effect on PPV",
                    "Higher prevalence leads to higher PPV (assuming constant sensitivity and specificity)",
                    "Higher prevalence leads to lower PPV",
                    "Prevalence only affects NPV, not PPV"
                ],
                correct: 1,
                explanation: "PPV increases as disease prevalence increases (holding sensitivity and specificity constant). This is because with higher prevalence, there are more true positives relative to false positives in the population, improving the probability that a positive test indicates disease presence."
            },
            {
                question: "What does a positive likelihood ratio (LR+) of 10 tell us about a diagnostic test?",
                options: [
                    "The test has 10% false positive rate",
                    "A positive test result is 10 times more likely in diseased than non-diseased patients",
                    "The test correctly identifies disease in 10% of cases",
                    "The test has 10% sensitivity"
                ],
                correct: 1,
                explanation: "LR+ = 10 means that a positive test result is 10 times more likely to occur in patients with disease than in patients without disease. This indicates strong evidence for disease when the test is positive, making it a very useful diagnostic finding."
            },
            {
                question: "In screening tests, why is high sensitivity typically more important than high specificity?",
                options: [
                    "Screening tests are always more sensitive than specific",
                    "High sensitivity minimizes missed cases (false negatives), which is crucial for early detection",
                    "Specificity doesn't matter in screening programs",
                    "High sensitivity reduces healthcare costs"
                ],
                correct: 1,
                explanation: "In screening, high sensitivity is prioritized to minimize false negatives (missed cases). Missing a disease in early stages when treatment is most effective can be devastating. While false positives from lower specificity cause anxiety and additional testing, missing disease cases has more serious consequences."
            },
            {
                question: "What is the optimal cutpoint on an ROC curve typically determined by?",
                options: [
                    "The point closest to the upper left corner (0,1)",
                    "The point that maximizes the sum of sensitivity and specificity",
                    "Clinical considerations weighing the consequences of false positives vs false negatives",
                    "All of the above can be valid approaches"
                ],
                correct: 3,
                explanation: "Optimal cutpoint selection can use multiple approaches: (1) closest to (0,1) maximizes overall accuracy, (2) Youden index maximizes sensitivity + specificity - 1, and (3) clinical considerations weighing costs of false positives vs false negatives. The best approach depends on the clinical context and relative consequences of different types of errors."
            }
        ];

        // Navigation Functions
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(sectionName).classList.add('active');
            event.target.classList.add('active');
        }

        // Diagnostic Model Management
        function updateDiagnosticModel() {
            const modelType = document.getElementById('diagnosticModel').value;
            const model = diagnosticModels[modelType];
            
            document.getElementById('diagnosticText').innerHTML = `
                <h3 style="color: var(--secondary-red); margin-bottom: 55px;">${model.title}</h3>
                <p><strong>Research Context:</strong> ${model.description}</p>
                <div class="research-note">
                    <p><strong>ü©∫ Clinical Context:</strong> ${model.clinical_context}</p>
                </div>
                <p><strong>Diagnostic Test:</strong> ${model.test}</p>
                <p><strong>Target Condition:</strong> ${model.condition}</p>
                <p><strong>Study Population:</strong> ${model.population}</p>
                <p><strong>Study Design:</strong> ${model.study_design}</p>
                <p><strong>Expected Performance:</strong> ${model.expected_performance}</p>
                <p><strong>Clinical Application:</strong> ${model.clinical_application}</p>
            `;
            
            updateDiagnosticMetrics();
        }

        function updateDiagnosticMetrics() {
            const analysisType = document.getElementById('analysisType').value;
            const container = document.getElementById('diagnosticModelMetrics');
            container.innerHTML = '';
            
            let metrics = [];
            switch(analysisType) {
                case 'roc_analysis': metrics = ['AUC', 'Sensitivity', 'Specificity', 'Youden Index']; break;
                case 'performance_metrics': metrics = ['PPV', 'NPV', 'LR+', 'LR-']; break;
                case 'threshold_optimization': metrics = ['Optimal Cut', 'Balanced Acc', 'F1-Score', 'DOR']; break;
                case 'multiclass_roc': metrics = ['Macro-AUC', 'Micro-AUC', 'Class AUCs', 'VUS']; break;
            }
            
            metrics.forEach((metric, index) => {
                const metricDiv = document.createElement('div');
                metricDiv.className = 'diagnostic-metric-card';
                metricDiv.textContent = metric;
                container.appendChild(metricDiv);
            });
        }

        function updateAccuracyDisplay() {
            const auc = document.getElementById('testAccuracy').value;
            let interpretation;
            if (auc < 0.7) interpretation = 'Poor accuracy';
            else if (auc < 0.8) interpretation = 'Acceptable accuracy';
            else if (auc < 0.9) interpretation = 'Excellent accuracy';
            else interpretation = 'Outstanding accuracy';
            document.getElementById('accuracyValue').textContent = `${auc} (${interpretation})`;
        }

        // Diagnostic Data Generation
        function generateDiagnosticData() {
            const modelType = document.getElementById('diagnosticModel').value;
            const analysisType = document.getElementById('analysisType').value;
            const prevalence = parseInt(document.getElementById('diseasePrevalence').value) / 100;
            const sampleSize = parseInt(document.getElementById('sampleSizeDiagnostic').value);
            const targetAUC = parseFloat(document.getElementById('testAccuracy').value);
            
            const model = diagnosticModels[modelType];
            
            currentDiagnosticModel = {
                model: model,
                analysisType: analysisType,
                prevalence: prevalence,
                sampleSize: sampleSize,
                targetAUC: targetAUC,
                diagnosticData: []
            };

            // Generate diagnostic test data with realistic medical patterns
            generateTestResults(sampleSize, prevalence, targetAUC);
            updateDiagnosticChart();
        }

        function generateTestResults(n, prevalence, targetAUC) {
            const data = [];
            const nDiseased = Math.round(n * prevalence);
            const nHealthy = n - nDiseased;
            
            // Generate test scores that achieve target AUC
            // For diseased: higher scores (right-shifted distribution)
            // For healthy: lower scores (left-shifted distribution)
            
            for (let i = 0; i < nDiseased; i++) {
                // Diseased subjects - higher test scores
                const score = Math.max(0, Math.min(100, 
                    Math.random() * 30 + 60 + (targetAUC - 0.5) * 40));
                
                data.push({
                    patientId: `D-${i}`,
                    diseaseStatus: 1,
                    testScore: score,
                    group: 'Diseased'
                });
            }
            
            for (let i = 0; i < nHealthy; i++) {
                // Healthy subjects - lower test scores
                const score = Math.max(0, Math.min(100, 
                    Math.random() * 30 + 20 + (1 - targetAUC) * 40));
                
                data.push({
                    patientId: `H-${i}`,
                    diseaseStatus: 0,
                    testScore: score,
                    group: 'Healthy'
                });
            }
            
            currentDiagnosticModel.diagnosticData = data;
        }

        function updateDiagnosticChart() {
            if (!currentDiagnosticModel) return;
            
            const ctx = document.getElementById('diagnosticChart').getContext('2d');
            
            if (currentDiagnosticChart) {
                currentDiagnosticChart.destroy();
            }

            // Create test score distribution histogram
            const data = currentDiagnosticModel.diagnosticData;
            const diseasedScores = data.filter(d => d.diseaseStatus === 1).map(d => d.testScore);
            const healthyScores = data.filter(d => d.diseaseStatus === 0).map(d => d.testScore);
            
            // Create histograms
            const bins = 20;
            const maxScore = 100;
            const binWidth = maxScore / bins;
            
            const diseasedHist = createHistogram(diseasedScores, bins, maxScore);
            const healthyHist = createHistogram(healthyScores, bins, maxScore);
            
            const labels = [];
            for (let i = 0; i < bins; i++) {
                labels.push((i * binWidth).toFixed(1));
            }

            currentDiagnosticChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Healthy',
                            data: healthyHist,
                            backgroundColor: 'rgba(71, 85, 105, 0.7)',
                            borderColor: '#475569',
                            borderWidth: 2
                        },
                        {
                            label: 'Diseased',
                            data: diseasedHist,
                            backgroundColor: 'rgba(185, 28, 28, 0.7)',
                            borderColor: '#B91C1C',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `${currentDiagnosticModel.model.title} - Test Score Distribution`,
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Test Score' } },
                        y: { title: { display: true, text: 'Frequency' } }
                    }
                }
            });
        }

        function createHistogram(data, bins, maxValue) {
            const hist = new Array(bins).fill(0);
            const binWidth = maxValue / bins;
            
            data.forEach(value => {
                const binIndex = Math.min(Math.floor(value / binWidth), bins - 1);
                hist[binIndex]++;
            });
            
            return hist;
        }

        // Diagnostic Analysis
        function performDiagnosticAnalysis() {
            if (!currentDiagnosticModel) {
                alert('Please generate diagnostic data first');
                return;
            }

            const data = currentDiagnosticModel.diagnosticData;
            const analysisType = currentDiagnosticModel.analysisType;
            
            // Calculate optimal threshold using Youden index
            const thresholds = [];
            for (let threshold = 0; threshold <= 100; threshold += 1) {
                const metrics = calculatePerformanceMetrics(data, threshold);
                thresholds.push({
                    threshold: threshold,
                    sensitivity: metrics.sensitivity,
                    specificity: metrics.specificity,
                    youden: metrics.sensitivity + metrics.specificity - 1,
                    ...metrics
                });
            }
            
            // Find optimal threshold
            const optimalThreshold = thresholds.reduce((best, current) => 
                current.youden > best.youden ? current : best
            );
            
            const analysisResults = {
                analysisName: getAnalysisName(analysisType),
                optimalThreshold: optimalThreshold,
                thresholds: thresholds,
                auc: calculateAUC(thresholds)
            };

            displayDiagnosticResults(analysisResults);
        }

        function calculatePerformanceMetrics(data, threshold) {
            let tp = 0, tn = 0, fp = 0, fn = 0;
            
            data.forEach(patient => {
                const testPositive = patient.testScore >= threshold;
                const diseasePositive = patient.diseaseStatus === 1;
                
                if (testPositive && diseasePositive) tp++;
                else if (!testPositive && !diseasePositive) tn++;
                else if (testPositive && !diseasePositive) fp++;
                else if (!testPositive && diseasePositive) fn++;
            });
            
            const sensitivity = tp / (tp + fn);
            const specificity = tn / (tn + fp);
            const ppv = tp / (tp + fp);
            const npv = tn / (tn + fn);
            const lrPlus = sensitivity / (1 - specificity);
            const lrMinus = (1 - sensitivity) / specificity;
            const dor = lrPlus / lrMinus;
            const accuracy = (tp + tn) / (tp + tn + fp + fn);
            
            return {
                tp, tn, fp, fn,
                sensitivity, specificity, ppv, npv,
                lrPlus, lrMinus, dor, accuracy
            };
        }

        function calculateAUC(thresholds) {
            // Trapezoidal rule for AUC calculation
            let auc = 0;
            for (let i = 1; i < thresholds.length; i++) {
                const x1 = 1 - thresholds[i-1].specificity; // FPR
                const y1 = thresholds[i-1].sensitivity; // TPR
                const x2 = 1 - thresholds[i].specificity;
                const y2 = thresholds[i].sensitivity;
                
                auc += (x2 - x1) * (y1 + y2) / 2;
            }
            return Math.abs(auc);
        }

        function getAnalysisName(analysisType) {
            const names = {
                'roc_analysis': 'ROC Curve Analysis',
                'performance_metrics': 'Diagnostic Performance Metrics',
                'threshold_optimization': 'Threshold Optimization Analysis',
                'multiclass_roc': 'Multi-Class ROC Analysis'
            };
            return names[analysisType] || 'Diagnostic Test Analysis';
        }

        function displayDiagnosticResults(results) {
            const model = currentDiagnosticModel.model;
            const optimal = results.optimalThreshold;
            const auc = results.auc;
            const significance = auc > 0.7 ? '‚úÖ Clinically Useful' : '‚ùå Poor Performance';
            
            let resultContent = `
                <h4>ü©∫ Diagnostic Test Results</h4>
                <div style="background: var(--primary-crimson); color: white; padding: 24px; border-radius: 18px; margin-bottom: 30px; text-align: center;">
                    <strong>${results.analysisName.toUpperCase()}</strong><br>
                    Study: ${model.title}<br>
                    AUC = ${auc.toFixed(3)}, Optimal Threshold = ${optimal.threshold.toFixed(1)} (${significance})
                </div>
            `;
            
            // Confusion matrix at optimal threshold
            resultContent += `
                <div class="confusion-matrix">
                    <h5>Confusion Matrix at Optimal Threshold (${optimal.threshold.toFixed(1)})</h5>
                    <table>
                        <tr><th></th><th>Disease +</th><th>Disease -</th><th>Total</th></tr>
                        <tr><th>Test +</th><td class="true-pos">${optimal.tp}</td><td class="false-pos">${optimal.fp}</td><td>${optimal.tp + optimal.fp}</td></tr>
                        <tr><th>Test -</th><td class="false-neg">${optimal.fn}</td><td class="true-neg">${optimal.tn}</td><td>${optimal.fn + optimal.tn}</td></tr>
                        <tr><th>Total</th><td>${optimal.tp + optimal.fn}</td><td>${optimal.fp + optimal.tn}</td><td>${optimal.tp + optimal.tn + optimal.fp + optimal.fn}</td></tr>
                    </table>
                </div>
            `;
            
            resultContent += `
                <div class="diagnostic-highlight">
                    <p><strong>ü©∫ Advanced Diagnostic Test Interpretation:</strong> 
                    The ${results.analysisName.toLowerCase()} demonstrates ${auc > 0.8 ? 'excellent' : auc > 0.7 ? 'acceptable' : 'poor'} diagnostic performance 
                    (AUC = ${auc.toFixed(3)}, ${significance}). 
                    At the optimal threshold (${optimal.threshold.toFixed(1)}), the test achieves ${(optimal.sensitivity * 100).toFixed(1)}% sensitivity 
                    and ${(optimal.specificity * 100).toFixed(1)}% specificity. 
                    This sophisticated diagnostic evaluation accounts for clinical consequences and provides evidence-based threshold recommendations.
                    <span class="canada-diagnostic">Canadian validation</span> 
                    supports implementation in clinical practice with appropriate quality assurance and monitoring protocols.
                    </p>
                </div>
            `;
            
            document.getElementById('diagnosticTable').innerHTML = resultContent;

            // Update diagnostic statistics display
            document.getElementById('diagnosticStats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${auc.toFixed(3)}</div>
                    <div class="stat-label">AUC</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${(optimal.sensitivity * 100).toFixed(1)}%</div>
                    <div class="stat-label">Sensitivity</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${(optimal.specificity * 100).toFixed(1)}%</div>
                    <div class="stat-label">Specificity</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${(optimal.ppv * 100).toFixed(1)}%</div>
                    <div class="stat-label">PPV</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${optimal.lrPlus.toFixed(1)}</div>
                    <div class="stat-label">LR+</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${optimal.threshold.toFixed(1)}</div>
                    <div class="stat-label">Optimal Cutoff</div>
                </div>
            `;
        }

        function performROCModeling() {
            if (!currentDiagnosticModel) {
                alert('Please perform diagnostic analysis first');
                return;
            }

            generateROCChart();
            displayROCAnalysis();
        }

        function generateROCChart() {
            const ctx = document.getElementById('rocChart').getContext('2d');
            
            if (rocChart) {
                rocChart.destroy();
            }

            // Generate ROC curve data
            const data = currentDiagnosticModel.diagnosticData;
            const rocPoints = [];
            
            for (let threshold = 100; threshold >= 0; threshold -= 1) {
                const metrics = calculatePerformanceMetrics(data, threshold);
                rocPoints.push({
                    x: 1 - metrics.specificity, // FPR
                    y: metrics.sensitivity // TPR
                });
            }
            
            // Add diagonal reference line (random classifier)
            const diagonalLine = [
                { x: 0, y: 0 },
                { x: 1, y: 1 }
            ];

            rocChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [
                        {
                            label: 'ROC Curve',
                            data: rocPoints,
                            borderColor: '#B91C1C',
                            backgroundColor: 'rgba(185, 28, 28, 0.1)',
                            borderWidth: 4,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 0
                        },
                        {
                            label: 'Random Classifier',
                            data: diagonalLine,
                            borderColor: '#6B7280',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { 
                            title: { display: true, text: '1 - Specificity (False Positive Rate)' },
                            min: 0,
                            max: 1
                        },
                        y: { 
                            title: { display: true, text: 'Sensitivity (True Positive Rate)' },
                            min: 0,
                            max: 1
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: `ROC Curve - AUC = ${currentDiagnosticModel.auc || calculateAUC(rocPoints).toFixed(3)}`,
                            font: { size: 16, weight: 'bold' }
                        }
                    }
                }
            });
        }

        function displayROCAnalysis() {
            const model = currentDiagnosticModel.model;
            const auc = calculateAUC(currentDiagnosticModel.diagnosticData ? 
                generateThresholdData(currentDiagnosticModel.diagnosticData) : []);
            
            // Calculate additional ROC metrics
            const youden = 0.35 + Math.random() * 0.3; // Simulated Youden index
            const optimalSe = 0.75 + Math.random() * 0.2;
            const optimalSp = 0.80 + Math.random() * 0.15;
            
            document.getElementById('rocTable').innerHTML = `
                <h4>ü©∫ Advanced ROC Analysis</h4>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 65px; margin: 60px 0;">
                    <div class="stat-card" style="padding: 60px;">
                        <h5>ROC Performance Metrics</h5>
                        <div class="roc-curve-info">
                            <div class="roc-metric">AUC<br>${auc.toFixed(3)}</div>
                            <div class="roc-metric">Youden<br>${youden.toFixed(3)}</div>
                            <div class="roc-metric">Optimal Se<br>${(optimalSe * 100).toFixed(1)}%</div>
                        </div>
                        <p><strong>AUC Interpretation:</strong> ${auc > 0.9 ? 'Outstanding' : auc > 0.8 ? 'Excellent' : auc > 0.7 ? 'Acceptable' : 'Poor'} diagnostic accuracy</p>
                        <p><strong>Clinical Utility:</strong> ${auc > 0.8 ? 'Suitable for clinical implementation' : 'May require improvement'}</p>
                    </div>
                    
                    <div class="stat-card" style="padding: 60px;">
                        <h5>Clinical Decision Analysis</h5>
                        <p><strong>Threshold Strategy:</strong> Balanced approach optimizing sensitivity and specificity</p>
                        <p><strong>Clinical Context:</strong> ${model.clinical_context}</p>
                        <p><strong>Implementation:</strong> Requires validation in target population and clinical setting</p>
                        <p><strong>Quality Assurance:</strong> Ongoing monitoring of test performance and calibration</p>
                    </div>
                </div>
                
                <div class="diagnostic-highlight">
                    <p><strong>ü©∫ Advanced ROC Analysis Interpretation:</strong> 
                    The ROC analysis reveals ${auc > 0.8 ? 'excellent' : auc > 0.7 ? 'acceptable' : 'suboptimal'} discriminative ability 
                    (AUC = ${auc.toFixed(3)}) for distinguishing diseased from healthy individuals. 
                    The optimal operating point balances sensitivity (${(optimalSe * 100).toFixed(1)}%) and specificity (${(optimalSp * 100).toFixed(1)}%) 
                    to maximize overall diagnostic utility. ROC methodology provides robust evaluation independent of decision thresholds.
                    <span class="canada-diagnostic">Canadian diagnostic standards</span> 
                    require external validation and implementation research before clinical adoption.
                    </p>
                </div>
            `;
        }

        function generateThresholdData(data) {
            const thresholds = [];
            for (let threshold = 0; threshold <= 100; threshold += 1) {
                const metrics = calculatePerformanceMetrics(data, threshold);
                thresholds.push({
                    threshold: threshold,
                    sensitivity: metrics.sensitivity,
                    specificity: metrics.specificity
                });
            }
            return thresholds;
        }

        // Assessment Functions
        function generateNewQuestion() {
            currentQuestion = assessmentQuestions[Math.floor(Math.random() * assessmentQuestions.length)];
            selectedAnswer = null;
            
            document.querySelector('.decision-question').textContent = currentQuestion.question;
            
            const optionsContainer = document.getElementById('assessmentOptions');
            optionsContainer.innerHTML = '';
            
            currentQuestion.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'decision-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('assessmentFeedback').innerHTML = '';
        }

        function selectAnswer(answerIndex) {
            selectedAnswer = answerIndex;
            
            document.querySelectorAll('.decision-option').forEach((option, index) => {
                option.classList.toggle('selected', index === answerIndex);
            });
        }

        function checkAnswer() {
            if (selectedAnswer === null) {
                alert('Please select an answer first');
                return;
            }
            
            const isCorrect = selectedAnswer === currentQuestion.correct;
            const feedbackClass = isCorrect ? 'feedback-success' : 'feedback-danger';
            const feedbackTitle = isCorrect ? '‚úì Correct!' : '‚úó Incorrect';
            
            document.getElementById('assessmentFeedback').innerHTML = `
                <div class="${feedbackClass}">
                    <h4>${feedbackTitle}</h4>
                    <p><strong>Explanation:</strong> ${currentQuestion.explanation}</p>
                    <p><strong>Correct Answer:</strong> ${currentQuestion.options[currentQuestion.correct]}</p>
                </div>
            `;
        }

        function showExpertSolution() {
            if (!currentQuestion) {
                generateNewQuestion();
                return;
            }
            
            document.getElementById('assessmentFeedback').innerHTML = `
                <div class="feedback-success">
                    <h4>ü©∫ Advanced Diagnostic Test Analysis</h4>
                    <p><strong>Correct Answer:</strong> ${currentQuestion.options[currentQuestion.correct]}</p>
                    <p><strong>Diagnostic Insight:</strong> ${currentQuestion.explanation}</p>
                    <p><strong>Clinical Application:</strong> Diagnostic test evaluation provides essential methodology for assessing clinical test performance and establishing evidence-based diagnostic protocols. Understanding sensitivity, specificity, predictive values, and ROC analysis is crucial for health technology assessment, clinical decision-making, and quality improvement. These rigorous methods enable optimal test selection, threshold establishment, and diagnostic algorithm development across diverse healthcare applications.</p>
                </div>
            `;
        }

        // Initialize page
        window.addEventListener('load', function() {
            updateDiagnosticModel();
            generateNewQuestion();
        });
    </script>
</body>
</html>
