<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foundation Series: Descriptive Medical Statistics & Healthcare Data Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&family=Source+Sans+Pro:wght@300;400;600;700&family=Roboto+Mono:wght@400;500;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        :root {
            --primary-blue: #007BA7;
            --secondary-red: #DC2626;
            --light-blue: #20B2AA;
            --pale-blue: #E0F2F1;
            --teal: #008B8B;
            --medical-green: #4CAF50;
            --clinical-gray: #546E7A;
            --warm-orange: #FF7043;
            --health-purple: #7B1FA2;
            --silver: #B0BEC5;
            --charcoal: #263238;
            --slate: #455A64;
            --cream: #F8F9FA;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #F0F8FF 50%, var(--pale-blue) 100%);
            color: var(--charcoal);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        /* Medical Data Flow Background */
        body::before {
            content: '';
            position: fixed;
            top: -60%;
            left: -60%;
            width: 220%;
            height: 220%;
            background: 
                radial-gradient(ellipse at 30% 30%, rgba(0, 123, 167, 0.05) 0%, transparent 60%),
                radial-gradient(ellipse at 70% 70%, rgba(32, 178, 170, 0.06) 0%, transparent 55%),
                radial-gradient(ellipse at 90% 20%, rgba(76, 175, 80, 0.04) 0%, transparent 50%),
                radial-gradient(ellipse at 20% 80%, rgba(255, 112, 67, 0.035) 0%, transparent 45%);
            animation: medicalFlow 40s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes medicalFlow {
            0%, 100% { 
                transform: rotate(0deg) scale(1) translate(0, 0); 
                opacity: 0.8; 
            }
            25% { 
                transform: rotate(90deg) scale(1.1) translate(15px, -15px); 
                opacity: 1; 
            }
            50% { 
                transform: rotate(180deg) scale(0.9) translate(-10px, 10px); 
                opacity: 0.85; 
            }
            75% { 
                transform: rotate(270deg) scale(1.05) translate(10px, -5px); 
                opacity: 0.9; 
            }
        }

        /* Healthcare Grid Pattern */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(45deg, 
                    transparent 0px, 
                    rgba(0, 123, 167, 0.02) 1px, 
                    transparent 2px, 
                    transparent 60px),
                repeating-linear-gradient(-45deg, 
                    transparent 0px, 
                    rgba(32, 178, 170, 0.015) 1px, 
                    transparent 2px, 
                    transparent 80px);
            z-index: -1;
            animation: healthcareGrid 25s linear infinite;
        }

        @keyframes healthcareGrid {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(60px) translateY(80px); }
        }

        .container {
            max-width: 1800px;
            margin: 30px auto;
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 
                0 0 80px rgba(0, 123, 167, 0.1),
                0 20px 60px rgba(32, 178, 170, 0.08),
                0 10px 30px rgba(76, 175, 80, 0.06);
            border-radius: 35px;
            overflow: hidden;
            backdrop-filter: blur(15px);
            animation: medicalEntry 2.5s cubic-bezier(0.23, 1, 0.32, 1);
            border: 1px solid rgba(0, 123, 167, 0.12);
        }

        @keyframes medicalEntry {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(60px) rotateX(15deg);
                filter: blur(15px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0) rotateX(0deg);
                filter: blur(0);
            }
        }

        /* Medical Header Design */
        .header-section {
            background: linear-gradient(135deg, var(--charcoal) 0%, var(--primary-blue) 35%, var(--teal) 70%, #006064 100%);
            color: white;
            padding: 60px 50px;
            position: relative;
            overflow: hidden;
        }

        .header-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(70deg, 
                transparent 0%, 
                rgba(32, 178, 170, 0.12) 15%, 
                transparent 30%, 
                rgba(76, 175, 80, 0.1) 45%, 
                transparent 60%, 
                rgba(255, 112, 67, 0.08) 75%, 
                transparent 90%);
            animation: medicalHeader 12s ease-in-out infinite;
        }

        @keyframes medicalHeader {
            0%, 100% { 
                transform: translateX(-80px) scaleY(1); 
                opacity: 0.9; 
            }
            33% { 
                transform: translateX(50px) scaleY(1.1); 
                opacity: 1; 
            }
            66% { 
                transform: translateX(-25px) scaleY(0.95); 
                opacity: 0.95; 
            }
        }

        .header-title {
            font-family: 'Lato', sans-serif;
            font-size: 4.2em;
            font-weight: 900;
            margin-bottom: 25px;
            text-shadow: 3px 4px 12px rgba(0,0,0,0.5);
            position: relative;
            z-index: 2;
            background: linear-gradient(135deg, white 0%, var(--light-blue) 40%, #B2DFDB 70%, white 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleMedical 4s ease-in-out infinite alternate;
            letter-spacing: -2px;
        }

        @keyframes titleMedical {
            from { 
                filter: drop-shadow(0 0 15px rgba(32, 178, 170, 0.6)); 
                text-shadow: 0 0 30px rgba(76, 175, 80, 0.4);
            }
            to { 
                filter: drop-shadow(0 0 25px rgba(0, 123, 167, 0.7)); 
                text-shadow: 0 0 40px rgba(255, 112, 67, 0.5);
            }
        }

        .header-subtitle {
            font-size: 1.7em;
            font-weight: 400;
            opacity: 0.92;
            position: relative;
            z-index: 2;
            color: var(--light-blue);
            text-shadow: 2px 3px 8px rgba(0,0,0,0.4);
            letter-spacing: 1px;
            font-style: italic;
        }

        /* Medical Navigation */
        .nav-tabs {
            display: flex;
            background: linear-gradient(90deg, var(--primary-blue) 0%, var(--light-blue) 25%, var(--medical-green) 50%, var(--warm-orange) 75%, var(--primary-blue) 100%);
            padding: 0;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 4px 0 rgba(32, 178, 170, 0.5);
        }

        .nav-tabs::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 30%;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.08) 0%, 
                rgba(32, 178, 170, 0.15) 50%, 
                rgba(255,255,255,0.08) 100%);
            transform: translateX(-120%);
            animation: medicalNav 8s ease-in-out infinite;
        }

        @keyframes medicalNav {
            0%, 100% { transform: translateX(-120%); }
            50% { transform: translateX(350%); }
        }

        .tab-button {
            flex: 1;
            padding: 30px 30px;
            background: none;
            border: none;
            color: white;
            font-weight: 500;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            border-bottom: 5px solid transparent;
            position: relative;
            z-index: 2;
            letter-spacing: 0.5px;
        }

        .tab-button:hover {
            background: rgba(32, 178, 170, 0.2);
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            color: var(--cream);
        }

        .tab-button.active {
            background: rgba(32, 178, 170, 0.25);
            border-bottom-color: var(--warm-orange);
            font-weight: 600;
            color: var(--cream);
            box-shadow: inset 0 -5px 0 var(--warm-orange);
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 60px;
            animation: medicalSlide 1.2s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .content-section.active {
            display: block;
        }

        @keyframes medicalSlide {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.98);
                filter: blur(6px);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        /* Section Titles - RED (Consistency) */
        .section-title {
            font-family: 'Lato', sans-serif;
            font-size: 3.4em;
            color: var(--secondary-red);
            margin-bottom: 50px;
            text-align: center;
            font-weight: 700;
            position: relative;
            text-shadow: 2px 3px 8px rgba(0,0,0,0.1);
            letter-spacing: -1px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 160px;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--light-blue) 0%, 
                var(--medical-green) 20%, 
                var(--warm-orange) 40%, 
                var(--health-purple) 60%, 
                var(--primary-blue) 80%, 
                var(--light-blue) 100%);
            border-radius: 3px;
            animation: medicalUnderline 5s ease-in-out infinite alternate;
        }

        @keyframes medicalUnderline {
            from { width: 160px; opacity: 0.8; }
            to { width: 220px; opacity: 1; }
        }

        /* Medical Blue/Teal Boxes - Foundation Framework */
        .theory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
            gap: 40px;
            margin-bottom: 60px;
        }

        .theory-card {
            background: linear-gradient(135deg, var(--pale-blue) 0%, #F0F8FF 50%, var(--white) 100%);
            padding: 45px;
            border-radius: 25px;
            border: 4px solid var(--light-blue);
            box-shadow: 
                0 15px 45px rgba(0, 123, 167, 0.08),
                0 8px 20px rgba(32, 178, 170, 0.1);
            transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .theory-card::before {
            content: '';
            position: absolute;
            top: -30px;
            right: -30px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, 
                rgba(32, 178, 170, 0.08) 0%, 
                rgba(0, 123, 167, 0.06) 40%, 
                transparent 70%);
            border-radius: 50%;
            animation: cardMedical 8s ease-in-out infinite;
        }

        @keyframes cardMedical {
            0%, 100% { 
                transform: scale(1) translateX(0) translateY(0) rotate(0deg); 
                opacity: 0.9; 
            }
            25% { 
                transform: scale(1.15) translateX(20px) translateY(-20px) rotate(90deg); 
                opacity: 1; 
            }
            50% { 
                transform: scale(0.85) translateX(-10px) translateY(10px) rotate(180deg); 
                opacity: 0.85; 
            }
            75% { 
                transform: scale(1.05) translateX(10px) translateY(-5px) rotate(270deg); 
                opacity: 0.95; 
            }
        }

        .theory-card:hover {
            transform: translateY(-12px) rotateX(8deg) rotateY(2deg);
            box-shadow: 
                0 25px 60px rgba(0, 123, 167, 0.12),
                0 10px 25px rgba(32, 178, 170, 0.15);
            border-color: var(--primary-blue);
        }

        .theory-card h3 {
            font-family: 'Lato', sans-serif;
            color: var(--secondary-red);
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 700;
            position: relative;
            z-index: 2;
            letter-spacing: -0.5px;
        }

        .theory-card p {
            font-size: 1.1em;
            line-height: 1.8;
            margin-bottom: 18px;
            position: relative;
            z-index: 2;
            font-weight: 400;
        }

        /* Mathematical Formulas - Medical Style */
        .formula-display {
            background: linear-gradient(135deg, var(--charcoal) 0%, var(--primary-blue) 50%, var(--teal) 100%);
            color: white;
            padding: 35px;
            border-radius: 18px;
            margin: 30px 0;
            font-family: 'Roboto Mono', monospace;
            font-size: 1.2em;
            box-shadow: 
                inset 0 3px 20px rgba(0,0,0,0.4), 
                0 12px 35px rgba(0, 123, 167, 0.25);
            overflow-x: auto;
            border: 3px solid rgba(32, 178, 170, 0.4);
            position: relative;
        }

        .formula-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--light-blue) 20%, 
                var(--medical-green) 40%, 
                var(--warm-orange) 60%, 
                var(--health-purple) 80%, 
                transparent 100%);
            animation: formulaMedical 4s ease-in-out infinite;
        }

        @keyframes formulaMedical {
            0%, 100% { opacity: 0.7; transform: scaleX(0.7); }
            50% { opacity: 1; transform: scaleX(1.3); }
        }

        /* Medical Blue Control Panel */
        .control-panel {
            background: linear-gradient(135deg, var(--pale-blue) 0%, #F0F8FF 50%, var(--white) 100%);
            padding: 50px;
            border-radius: 28px;
            margin: 50px 0;
            border: 4px solid var(--light-blue);
            box-shadow: 
                0 18px 55px rgba(32, 178, 170, 0.15),
                inset 0 1px 0 rgba(255,255,255,0.95);
            position: relative;
            overflow: hidden;
        }

        .control-panel::before {
            content: '';
            position: absolute;
            top: -80%;
            left: -80%;
            width: 260%;
            height: 260%;
            background: conic-gradient(from 45deg at 50% 50%, 
                transparent 0%, 
                rgba(32, 178, 170, 0.03) 25%, 
                transparent 50%, 
                rgba(0, 123, 167, 0.025) 75%, 
                transparent 100%);
            animation: controlMedical 20s linear infinite;
        }

        @keyframes controlMedical {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .control-header {
            font-family: 'Lato', sans-serif;
            color: var(--secondary-red);
            font-size: 2.5em;
            margin-bottom: 35px;
            text-align: center;
            font-weight: 700;
            position: relative;
            z-index: 2;
            letter-spacing: -0.5px;
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 35px;
            margin-bottom: 40px;
            position: relative;
            z-index: 2;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--charcoal);
            font-size: 1.1em;
            letter-spacing: 0.3px;
        }

        .form-group select,
        .form-group input {
            padding: 18px;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            font-size: 1.05em;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 
                0 0 25px rgba(0, 123, 167, 0.25),
                0 0 0 3px rgba(32, 178, 170, 0.15);
            transform: translateY(-3px) scale(1.01);
        }

        /* Medical Action Buttons */
        .button-group {
            display: flex;
            gap: 25px;
            margin-top: 40px;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        .btn {
            padding: 20px 40px;
            border: none;
            border-radius: 14px;
            font-weight: 600;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255,255,255,0.5) 50%, 
                transparent 100%);
            transition: left 0.7s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--teal) 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(0, 123, 167, 0.35);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--teal) 0%, var(--primary-blue) 100%);
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(0, 123, 167, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--medical-green) 0%, #388E3C 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.35);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #388E3C 0%, var(--medical-green) 100%);
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(76, 175, 80, 0.4);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--warm-orange) 0%, #E64A19 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(255, 112, 67, 0.35);
        }

        .btn-accent:hover {
            background: linear-gradient(135deg, #E64A19 0%, var(--warm-orange) 100%);
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(255, 112, 67, 0.4);
        }

        /* Medical Blue Results Container */
        .results-container {
            background: linear-gradient(135deg, var(--pale-blue) 0%, #F0F8FF 100%);
            border: 4px solid var(--light-blue);
            border-radius: 25px;
            padding: 50px;
            margin: 50px 0;
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.95);
            position: relative;
            overflow: hidden;
        }

        .results-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, 
                var(--light-blue) 0%, 
                var(--medical-green) 16%, 
                var(--warm-orange) 32%, 
                var(--health-purple) 48%, 
                var(--primary-blue) 64%, 
                var(--teal) 80%, 
                var(--light-blue) 100%);
            animation: medicalResults 4s ease-in-out infinite;
        }

        @keyframes medicalResults {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .results-header {
            font-family: 'Lato', sans-serif;
            font-size: 2.5em;
            color: var(--secondary-red);
            margin-bottom: 35px;
            text-align: center;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        /* Medical Blue Chart Container */
        .chart-container {
            position: relative;
            height: 550px;
            margin: 50px 0;
            background: linear-gradient(135deg, var(--pale-blue) 0%, var(--white) 100%);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            border: 3px solid var(--light-blue);
        }

        /* Statistics Grid - Medical Blue Theme */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 35px;
            margin: 45px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--pale-blue) 0%, var(--white) 100%);
            padding: 35px;
            border-radius: 18px;
            text-align: center;
            border: 3px solid var(--light-blue);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--light-blue) 0%, var(--primary-blue) 50%, var(--medical-green) 100%);
            transform: scaleX(0);
            transition: transform 0.5s ease;
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-value {
            font-family: 'Roboto Mono', monospace;
            font-size: 1.9em;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 12px;
        }

        .stat-label {
            font-size: 1em;
            color: var(--slate);
            font-weight: 500;
        }

        /* Medical-Specific Elements */
        .medical-info {
            background: linear-gradient(135deg, var(--pale-blue) 0%, #E8F5E8 100%);
            border: 3px solid var(--light-blue);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .health-indicator {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .indicator-card {
            background: var(--primary-blue);
            color: white;
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.95em;
            font-weight: 600;
        }

        .indicator-card:nth-child(1) { background: var(--medical-green); }
        .indicator-card:nth-child(2) { background: var(--warm-orange); }
        .indicator-card:nth-child(3) { background: var(--primary-blue); }
        .indicator-card:nth-child(4) { background: var(--health-purple); }

        /* Decision Framework - Medical Blue */
        .decision-panel {
            background: linear-gradient(135deg, var(--pale-blue) 0%, rgba(32, 178, 170, 0.2) 100%);
            border: 4px solid var(--light-blue);
            border-radius: 25px;
            padding: 40px;
            margin: 40px 0;
        }

        .decision-question {
            font-family: 'Lato', sans-serif;
            font-weight: 600;
            font-size: 1.4em;
            margin-bottom: 30px;
            color: var(--charcoal);
            text-align: center;
            letter-spacing: -0.3px;
        }

        .decision-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }

        .decision-option {
            padding: 25px;
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.5s ease;
            text-align: center;
            font-weight: 500;
            font-size: 1.05em;
        }

        .decision-option:hover {
            border-color: var(--medical-green);
            background: #F1F8E9;
            transform: translateY(-5px);
        }

        .decision-option.selected {
            border-color: var(--primary-blue);
            background: var(--pale-blue);
            box-shadow: 0 0 25px rgba(0, 123, 167, 0.3);
        }

        /* Feedback Messages */
        .feedback-message {
            padding: 35px;
            border-radius: 18px;
            margin: 35px 0;
            font-weight: 500;
            font-size: 1.1em;
        }

        .feedback-success {
            background: var(--pale-blue);
            border: 4px solid var(--light-blue);
            color: var(--teal);
        }

        .feedback-warning {
            background: #FFF8E1;
            border: 4px solid var(--warm-orange);
            color: #8F6300;
        }

        .feedback-danger {
            background: #FFEBEE;
            border: 4px solid #DC2626;
            color: #8B0000;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin: 20px;
                border-radius: 25px;
            }

            .header-title {
                font-size: 3em;
            }

            .theory-grid {
                grid-template-columns: 1fr;
            }

            .control-group {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .button-group {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .health-indicator {
                grid-template-columns: 1fr;
            }
        }

        /* Research References - Medical Blue */
        .research-note {
            background: linear-gradient(135deg, var(--pale-blue) 0%, #E8F5E8 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            border-left: 6px solid var(--primary-blue);
            font-style: italic;
            position: relative;
        }

        .research-note::before {
            content: 'üè•';
            position: absolute;
            top: 30px;
            left: 25px;
            font-size: 1.3em;
        }

        .research-note p {
            margin-left: 40px;
            line-height: 1.8;
        }

        /* Advanced Visual Effects */
        .medical-highlight {
            background: rgba(0, 123, 167, 0.1);
            border-left: 5px solid var(--primary-blue);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .statistic-display {
            display: inline-block;
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--primary-blue) 100%);
            color: white;
            padding: 10px 18px;
            border-radius: 20px;
            font-family: 'Roboto Mono', monospace;
            font-weight: 600;
            margin: 0 10px;
            font-size: 0.95em;
        }

        /* Canadian Health Context */
        .canada-context {
            background: linear-gradient(135deg, #FF6B6B 0%, #DC2626 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 15px;
            font-family: 'Roboto Mono', monospace;
            font-weight: 600;
            font-size: 0.85em;
            display: inline-block;
            margin: 0 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header-section">
            <h1 class="header-title">Descriptive Medical Statistics & Healthcare Data Analysis</h1>
            <p class="header-subtitle">Foundation Series: Understanding Health Data Through Statistical Measures</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="tab-button active" onclick="showSection('theory')">ü©∫ Medical Stats Theory</button>
            <button class="tab-button" onclick="showSection('simulation')">üá®üá¶ Canadian Health Data</button>
            <button class="tab-button" onclick="showSection('analysis')">üìä Statistical Analysis</button>
            <button class="tab-button" onclick="showSection('assessment')">‚úÖ Assessment Mode</button>
        </div>

        <!-- Theory Framework Section -->
        <div id="theory" class="content-section active">
            <h2 class="section-title">Descriptive Medical Statistics Framework</h2>
            
            <div class="theory-grid">
                <div class="theory-card">
                    <h3>ü©∫ Medical Data Types</h3>
                    <p><strong>Understanding Healthcare Variables:</strong> Medical research involves diverse data types requiring specific statistical approaches for proper analysis and interpretation.</p>
                    <div class="formula-display">
                        Continuous: Height, weight, blood pressure, age<br>
                        Discrete: Number of hospitalizations, pills taken<br>
                        Categorical: Disease status, treatment response<br>
                        Ordinal: Pain scales (1-10), disease severity<br><br>
                        Key: Match statistical method to data type!
                    </div>
                    <p><em>Clinical insight: Inappropriate statistical methods can lead to incorrect medical conclusions</em></p>
                </div>

                <div class="theory-card">
                    <h3>üìä Measures of Central Tendency</h3>
                    <p><strong>Location Parameters:</strong> Central tendency measures describe typical values in medical data, but choice depends on data distribution and clinical context.</p>
                    <div class="formula-display">
                        Mean (xÃÑ): xÃÑ = Œ£x·µ¢/n<br>
                        Median: Middle value when ordered<br>
                        Mode: Most frequently occurring value<br><br>
                        Medical Rule: Use median for skewed health data
                    </div>
                    <p><strong>Clinical Application:</strong> Median survival time preferred over mean due to right-skewed survival distributions</p>
                </div>

                <div class="theory-card">
                    <h3>üìà Measures of Variability</h3>
                    <p><strong>Spread Parameters:</strong> Variability measures quantify dispersion in health outcomes, crucial for clinical significance assessment and treatment planning.</p>
                    <div class="formula-display">
                        Variance: s¬≤ = Œ£(x·µ¢ - xÃÑ)¬≤/(n-1)<br>
                        Standard Deviation: s = ‚àös¬≤<br>
                        IQR: Q‚ÇÉ - Q‚ÇÅ<br>
                        Coefficient of Variation: CV = s/xÃÑ<br><br>
                        CV useful for comparing variability across units
                    </div>
                    <p><strong>Medical Interpretation:</strong> High variability may indicate heterogeneous patient populations or measurement error</p>
                </div>

                <div class="theory-card">
                    <h3>üéØ Population Health Indicators</h3>
                    <p><strong>Epidemiological Measures:</strong> Population health statistics provide standardized methods for comparing health outcomes across groups and jurisdictions.</p>
                    <div class="formula-display">
                        Incidence Rate: New cases/Population at risk √ó 1000<br>
                        Prevalence: Existing cases/Total population √ó 100<br>
                        Mortality Rate: Deaths/Population √ó 1000<br>
                        Case Fatality Rate: Deaths from disease/Cases √ó 100
                    </div>
                    <p><strong>Public Health Application:</strong> Essential for disease surveillance and health system planning</p>
                </div>

                <div class="theory-card">
                    <h3>üìã Clinical vs. Statistical Significance</h3>
                    <p><strong>Medical Decision-Making:</strong> Statistical significance doesn't guarantee clinical relevance - effect size and clinical context determine practical importance.</p>
                    <div class="formula-display">
                        Statistical Significance: p &lt; 0.05<br>
                        Clinical Significance: Effect size ‚â• MCID<br>
                        MCID: Minimal Clinically Important Difference<br><br>
                        Both required for meaningful medical conclusions
                    </div>
                    <p><strong>Evidence-Based Medicine:</strong> Large samples can detect statistically significant but clinically irrelevant differences</p>
                </div>

                <div class="theory-card">
                    <h3>üî¨ Data Quality in Medical Research</h3>
                    <p><strong>Quality Assurance:</strong> Medical data quality directly impacts patient care decisions - systematic assessment of completeness, accuracy, and reliability is essential.</p>
                    <div class="formula-display">
                        Completeness: Non-missing/Total observations √ó 100<br>
                        Accuracy: Correct values/Total values √ó 100<br>
                        Reliability: Agreement between measurements<br><br>
                        Missing data patterns: MCAR, MAR, NMAR
                    </div>
                    <p><strong>Clinical Impact:</strong> Poor data quality can compromise patient safety and treatment effectiveness</p>
                </div>
            </div>

            <div class="theory-card" style="grid-column: 1 / -1;">
                <h3>üá®üá¶ Canadian Healthcare Statistics Applications</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 30px;">
                    <div>
                        <h4>üè• Hospital & Clinical Data:</h4>
                        <ul>
                            <li><strong>Length of Stay Analysis:</strong> Descriptive statistics for hospital efficiency</li>
                            <li><strong>Wait Time Monitoring:</strong> Central tendency and variability assessment</li>
                            <li><strong>Clinical Outcomes:</strong> Mortality rates, complication frequencies</li>
                            <li><strong>Resource Utilization:</strong> ICU occupancy, surgical volumes</li>
                        </ul>
                    </div>
                    <div>
                        <h4>üìä Population Health Surveillance:</h4>
                        <ul>
                            <li><strong>Disease Prevalence:</strong> Diabetes, hypertension, cancer rates</li>
                            <li><strong>Health Behaviors:</strong> Smoking, physical activity, nutrition</li>
                            <li><strong>Health Inequities:</strong> Disparities by geography, income, ethnicity</li>
                            <li><strong>Public Health Monitoring:</strong> Vaccination coverage, screening rates</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="research-note">
                <p><strong>üè• Evidence-Based Medicine Foundation:</strong> Descriptive statistics form the foundation of evidence-based medicine by providing standardized methods for summarizing and communicating health information. These tools enable healthcare professionals to understand patient populations, assess treatment variability, monitor quality indicators, and make informed clinical decisions. Proper application requires understanding both statistical principles and clinical context.</p>
            </div>
        </div>

        <!-- Canadian Health Data Applications Section -->
        <div id="simulation" class="content-section">
            <h2 class="section-title">Canadian Healthcare Data Laboratory</h2>

            <div class="control-panel">
                <h3 class="control-header">ü©∫ Medical Statistics Simulator</h3>
                
                <div class="control-group">
                    <div class="form-group">
                        <label for="healthDataset">Canadian Health Dataset</label>
                        <select id="healthDataset" onchange="updateHealthDataset()">
                            <option value="hospital_los">Hospital Length of Stay (CIHI DAD)</option>
                            <option value="wait_times">Surgical Wait Times (Provincial)</option>
                            <option value="chronic_disease">Chronic Disease Prevalence (CCHS)</option>
                            <option value="vaccination">Vaccination Coverage (PHAC)</option>
                            <option value="mental_health">Mental Health Indicators (NPHS)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="populationSize">Sample Size</label>
                        <select id="populationSize">
                            <option value="500">500 patients</option>
                            <option value="1500" selected>1,500 patients</option>
                            <option value="5000">5,000 patients</option>
                            <option value="10000">10,000 patients</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="distributionType">Data Distribution</label>
                        <select id="distributionType">
                            <option value="normal">Normal (symmetric)</option>
                            <option value="right_skewed" selected>Right-skewed (typical medical)</option>
                            <option value="left_skewed">Left-skewed</option>
                            <option value="bimodal">Bimodal</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="variabilityLevel">Data Variability</label>
                        <input type="range" id="variabilityLevel" min="0.5" max="3.0" step="0.1" value="1.2" onchange="updateVariabilityDisplay()">
                        <span id="variabilityValue">1.2</span> √ó standard variation
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="generateMedicalData()">ü©∫ Generate Data</button>
                    <button class="btn btn-secondary" onclick="calculateDescriptives()">üìä Calculate Statistics</button>
                    <button class="btn btn-accent" onclick="visualizeData()">üìà Create Charts</button>
                </div>
            </div>

            <!-- Health Dataset Description -->
            <div id="healthDescription" class="medical-info">
                <div class="results-header">Current Healthcare Dataset Analysis</div>
                <div id="healthText"></div>
                <div id="healthIndicators" class="health-indicator"></div>
            </div>

            <!-- Medical Data Chart -->
            <div class="chart-container">
                <canvas id="medicalChart"></canvas>
            </div>
        </div>

        <!-- Statistical Analysis Section -->
        <div id="analysis" class="content-section">
            <h2 class="section-title">Descriptive Statistics Analysis</h2>

            <div id="statisticsResults" class="results-container">
                <div class="results-header">Descriptive Statistics Summary</div>
                <div id="statisticsTable"></div>
            </div>

            <div class="stats-grid" id="medicalStats">
                <!-- Dynamic statistics will be populated here -->
            </div>

            <div id="clinicalResults" class="results-container">
                <div class="results-header">ü©∫ Clinical Interpretation & Population Health</div>
                <div id="clinicalTable"></div>
            </div>

            <!-- Distribution Visualization Chart -->
            <div class="chart-container">
                <h3 style="text-align: center; margin-bottom: 30px; color: var(--secondary-red);">üìä Data Distribution & Summary Statistics</h3>
                <canvas id="distributionChart"></canvas>
            </div>
        </div>

        <!-- Assessment Mode Section -->
        <div id="assessment" class="content-section">
            <h2 class="section-title">Medical Statistics Assessment</h2>

            <div id="assessmentQuestion" class="decision-panel">
                <div class="decision-question">Loading medical statistics assessment...</div>
                <div class="decision-options" id="assessmentOptions">
                    <!-- Dynamic options will be populated -->
                </div>
                <button class="btn btn-primary" onclick="checkAnswer()" style="margin-top: 35px;">Submit Answer</button>
            </div>

            <div id="assessmentFeedback"></div>

            <div class="button-group" style="margin-top: 45px;">
                <button class="btn btn-secondary" onclick="generateNewQuestion()">üìù New Question</button>
                <button class="btn btn-accent" onclick="showExpertSolution()">üéì Show Clinical Interpretation</button>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentMedicalData = null;
        let currentMedicalChart = null;
        let distributionChart = null;
        let selectedAnswer = null;
        let currentQuestion = null;

        // Health Dataset Definitions
        const healthDatasets = {
            hospital_los: {
                title: "Hospital Length of Stay Analysis (CIHI DAD)",
                description: "Analyzing acute care hospital length of stay using Canadian Institute for Health Information Discharge Abstract Database to understand patient flow and resource utilization patterns.",
                outcome: "Length of Stay (days)",
                population: "Acute care inpatients",
                source: "CIHI Discharge Abstract Database (DAD)",
                typical_values: "Mean: 7.2 days, Median: 4.1 days (right-skewed)",
                clinical_relevance: "Efficiency indicator for hospital resource management and patient care quality",
                factors: "Age, diagnosis, comorbidities, hospital size, geographic location",
                distribution_note: "Typically right-skewed due to few patients with very long stays",
                quality_indicators: "Readmission rates, in-hospital mortality, patient satisfaction"
            },
            wait_times: {
                title: "Surgical Wait Times Analysis (Provincial Data)",
                description: "Monitoring elective surgery wait times across Canadian provinces to evaluate healthcare system performance and wait time reduction initiatives.",
                outcome: "Wait Time from Decision to Treatment (days)",
                population: "Elective surgery patients",
                source: "Provincial wait time databases (WTIS)",
                typical_values: "Median: 45 days, 90th percentile: 120 days",
                clinical_relevance: "Patient access indicator and health system performance measure",
                factors: "Surgery type, priority level, hospital capacity, surgeon availability",
                distribution_note: "Right-skewed with potential outliers from emergency rescheduling",
                quality_indicators: "Wait time targets, patient outcomes, system capacity utilization"
            },
            chronic_disease: {
                title: "Chronic Disease Prevalence (Canadian Community Health Survey)",
                description: "Estimating chronic disease prevalence rates using CCHS data to understand population health burden and inform prevention strategies.",
                outcome: "Disease Prevalence (%)",
                population: "Canadian adults aged 18+",
                source: "Canadian Community Health Survey (CCHS)",
                typical_values: "Diabetes: 7.3%, Hypertension: 22.6%, Heart disease: 5.1%",
                clinical_relevance: "Population health planning and disease prevention targeting",
                factors: "Age, sex, income, education, geography, lifestyle factors",
                distribution_note: "Often normal or slightly skewed depending on demographic stratification",
                quality_indicators: "Health equity measures, prevention program effectiveness"
            },
            vaccination: {
                title: "Vaccination Coverage Analysis (Public Health Agency)",
                description: "Assessing vaccination coverage rates across age groups and regions to monitor immunization program effectiveness and identify gaps.",
                outcome: "Vaccination Coverage (%)",
                population: "Age-specific cohorts",
                source: "Public Health Agency of Canada (PHAC)",
                typical_values: "Routine childhood: 85-95%, Influenza: 35-40%, COVID-19: Variable",
                clinical_relevance: "Herd immunity assessment and outbreak prevention planning",
                factors: "Age, geographic region, socioeconomic status, healthcare access",
                distribution_note: "May be bimodal with high coverage in some groups, lower in others",
                quality_indicators: "Coverage targets, equity measures, outbreak frequency"
            },
            mental_health: {
                title: "Mental Health Indicators (National Population Health Survey)",
                description: "Analyzing mental health outcomes and service utilization using longitudinal population survey data to understand mental health trends.",
                outcome: "Mental Health Score (0-100)",
                population: "Canadian adults",
                source: "National Population Health Survey (NPHS)",
                typical_values: "Mean: 73.2, SD: 18.5, typically left-skewed (ceiling effects)",
                clinical_relevance: "Mental health system planning and intervention targeting",
                factors: "Age, employment, social support, chronic conditions, life events",
                distribution_note: "Often left-skewed due to ceiling effects and social desirability bias",
                quality_indicators: "Service access, treatment outcomes, stigma reduction measures"
            }
        };

        // Assessment Questions (Medical Statistics focused)
        const assessmentQuestions = [
            {
                question: "When analyzing hospital length of stay data, why is the median typically preferred over the mean?",
                options: [
                    "The median is easier to calculate",
                    "Length of stay data is usually right-skewed with outliers",
                    "The median is always more accurate", 
                    "Hospital administrators prefer percentile-based measures"
                ],
                correct: 1,
                explanation: "Length of stay data is typically right-skewed because most patients have short stays, but a few patients have very long stays. The median is less affected by these extreme values and provides a better representation of the typical patient experience."
            },
            {
                question: "What is the most appropriate measure of central tendency for pain scores on a 1-10 scale?",
                options: [
                    "Mean, because pain scores are continuous",
                    "Mode, because it identifies the most common pain level",
                    "Median, because pain scores are ordinal data",
                    "All three measures are equally appropriate"
                ],
                correct: 2,
                explanation: "Pain scores are ordinal data where the differences between scale points may not be equal. The median is most appropriate for ordinal data as it doesn't assume equal intervals between scale points, unlike the mean."
            },
            {
                question: "In a clinical trial with 100 patients, a new treatment shows a statistically significant improvement (p=0.04) of 2 points on a 100-point quality of life scale. What should you conclude?",
                options: [
                    "The treatment is clinically effective and should be implemented",
                    "The treatment shows statistical but may not show clinical significance",
                    "The p-value proves the treatment causes improvement",
                    "The treatment should be rejected because the effect is too small"
                ],
                correct: 1,
                explanation: "While the result is statistically significant, a 2-point improvement on a 100-point scale may not be clinically meaningful. Clinical significance requires the improvement to exceed the minimal clinically important difference (MCID) for that scale."
            },
            {
                question: "When comparing disease prevalence between provinces, which measure helps account for different population age structures?",
                options: [
                    "Crude prevalence rates",
                    "Age-standardized prevalence rates",
                    "Median age of cases",
                    "Disease incidence rates"
                ],
                correct: 1,
                explanation: "Age-standardized rates adjust for differences in age structure between populations, allowing fair comparison of disease burden across provinces with different demographic compositions."
            },
            {
                question: "In medical research, what does a high coefficient of variation (CV > 100%) typically indicate?",
                options: [
                    "The data is normally distributed",
                    "The measurement is very precise",
                    "There is high variability relative to the mean, suggesting heterogeneous populations",
                    "The sample size is too small"
                ],
                correct: 2,
                explanation: "A high coefficient of variation indicates high variability relative to the mean, often suggesting heterogeneous patient populations, different disease subtypes, or measurement issues that need investigation."
            }
        ];

        // Navigation Functions
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(sectionName).classList.add('active');
            event.target.classList.add('active');
        }

        // Health Dataset Management
        function updateHealthDataset() {
            const datasetType = document.getElementById('healthDataset').value;
            const dataset = healthDatasets[datasetType];
            
            document.getElementById('healthText').innerHTML = `
                <h3 style="color: var(--secondary-red); margin-bottom: 20px;">${dataset.title}</h3>
                <p><strong>Research Context:</strong> ${dataset.description}</p>
                <div class="research-note">
                    <p><strong>üè• Clinical Relevance:</strong> ${dataset.clinical_relevance}</p>
                </div>
                <p><strong>Outcome Variable:</strong> ${dataset.outcome}</p>
                <p><strong>Target Population:</strong> ${dataset.population}</p>
                <p><strong>Data Source:</strong> ${dataset.source}</p>
                <p><strong>Typical Values:</strong> ${dataset.typical_values}</p>
                <p><strong>Key Factors:</strong> ${dataset.factors}</p>
                <p><strong>Distribution:</strong> ${dataset.distribution_note}</p>
                <p><strong>Quality Indicators:</strong> ${dataset.quality_indicators}</p>
            `;
            
            updateHealthIndicators();
        }

        function updateHealthIndicators() {
            const datasetType = document.getElementById('healthDataset').value;
            const container = document.getElementById('healthIndicators');
            container.innerHTML = '';
            
            let indicators = [];
            switch(datasetType) {
                case 'hospital_los': indicators = ['Acute Care', 'Resource Util.', 'Patient Flow', 'Quality Measure']; break;
                case 'wait_times': indicators = ['Access Measure', 'System Performance', 'Patient Experience', 'Capacity Planning']; break;
                case 'chronic_disease': indicators = ['Pop. Health', 'Prevention Target', 'Health Burden', 'Risk Assessment']; break;
                case 'vaccination': indicators = ['Coverage Rate', 'Herd Immunity', 'Program Evaluation', 'Health Protection']; break;
                case 'mental_health': indicators = ['Wellbeing Score', 'Service Planning', 'Outcome Measure', 'Population Health']; break;
            }
            
            indicators.forEach((indicator, index) => {
                const indicatorDiv = document.createElement('div');
                indicatorDiv.className = 'indicator-card';
                indicatorDiv.textContent = indicator;
                container.appendChild(indicatorDiv);
            });
        }

        function updateVariabilityDisplay() {
            const variability = document.getElementById('variabilityLevel').value;
            document.getElementById('variabilityValue').textContent = variability;
        }

        // Medical Data Generation
        function generateMedicalData() {
            const datasetType = document.getElementById('healthDataset').value;
            const sampleSize = parseInt(document.getElementById('populationSize').value);
            const distributionType = document.getElementById('distributionType').value;
            const variabilityLevel = parseFloat(document.getElementById('variabilityLevel').value);
            
            const dataset = healthDatasets[datasetType];
            
            currentMedicalData = {
                dataset: dataset,
                sampleSize: sampleSize,
                distributionType: distributionType,
                variabilityLevel: variabilityLevel,
                data: []
            };

            // Generate medical data with appropriate distributions
            let baseValue, baseSD;
            switch(datasetType) {
                case 'hospital_los': baseValue = 7.2; baseSD = 8.5; break;
                case 'wait_times': baseValue = 45; baseSD = 35; break;
                case 'chronic_disease': baseValue = 15.8; baseSD = 12.2; break;
                case 'vaccination': baseValue = 78.5; baseSD = 18.3; break;
                case 'mental_health': baseValue = 73.2; baseSD = 18.5; break;
            }

            for (let i = 0; i < sampleSize; i++) {
                let value;
                
                switch(distributionType) {
                    case 'normal':
                        value = generateNormal(baseValue, baseSD * variabilityLevel);
                        break;
                    case 'right_skewed':
                        value = generateLogNormal(baseValue, baseSD * variabilityLevel);
                        break;
                    case 'left_skewed':
                        value = generateLeftSkewed(baseValue, baseSD * variabilityLevel);
                        break;
                    case 'bimodal':
                        value = generateBimodal(baseValue, baseSD * variabilityLevel);
                        break;
                }
                
                // Apply realistic bounds
                if (datasetType === 'vaccination' || datasetType === 'chronic_disease') {
                    value = Math.max(0, Math.min(100, value)); // Percentages
                } else if (datasetType === 'mental_health') {
                    value = Math.max(0, Math.min(100, value)); // Scale scores
                } else {
                    value = Math.max(0.1, value); // Positive values only
                }
                
                currentMedicalData.data.push({
                    id: i,
                    value: value,
                    age: 25 + Math.random() * 50,
                    sex: Math.random() < 0.52 ? 'Female' : 'Male',
                    region: Math.random() < 0.3 ? 'Rural' : 'Urban'
                });
            }

            updateMedicalChart();
        }

        function generateNormal(mean, sd) {
            // Box-Muller transform
            const u = 0.5 - Math.random();
            const v = 0.5 - Math.random();
            const z = Math.sqrt(-2 * Math.log(Math.abs(u))) * Math.cos(2 * Math.PI * v);
            return mean + sd * z;
        }

        function generateLogNormal(mean, sd) {
            const normal = generateNormal(0, 1);
            const logMean = Math.log(mean) - 0.5 * Math.log(1 + (sd / mean) ** 2);
            const logSD = Math.sqrt(Math.log(1 + (sd / mean) ** 2));
            return Math.exp(logMean + logSD * normal);
        }

        function generateLeftSkewed(mean, sd) {
            // Reflect right-skewed around mean
            const rightSkewed = generateLogNormal(mean, sd);
            return 2 * mean - rightSkewed;
        }

        function generateBimodal(mean, sd) {
            // Mixture of two normals
            if (Math.random() < 0.6) {
                return generateNormal(mean * 0.8, sd * 0.7);
            } else {
                return generateNormal(mean * 1.3, sd * 0.7);
            }
        }

        function updateMedicalChart() {
            if (!currentMedicalData) return;
            
            const ctx = document.getElementById('medicalChart').getContext('2d');
            
            if (currentMedicalChart) {
                currentMedicalChart.destroy();
            }

            // Create histogram
            const values = currentMedicalData.data.map(d => d.value);
            const minVal = Math.min(...values);
            const maxVal = Math.max(...values);
            const numBins = 25;
            const binWidth = (maxVal - minVal) / numBins;
            
            const histogram = Array(numBins).fill(0);
            values.forEach(value => {
                const bin = Math.min(Math.floor((value - minVal) / binWidth), numBins - 1);
                histogram[bin]++;
            });

            const labels = Array(numBins).fill(0).map((_, i) => (minVal + i * binWidth).toFixed(1));

            currentMedicalChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Frequency',
                            data: histogram,
                            backgroundColor: 'rgba(0, 123, 167, 0.7)',
                            borderColor: '#007BA7',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `${currentMedicalData.dataset.title} - Distribution`,
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: currentMedicalData.dataset.outcome }
                        },
                        y: {
                            title: { display: true, text: 'Frequency' }
                        }
                    }
                }
            });
        }

        // Statistical Analysis
        function calculateDescriptives() {
            if (!currentMedicalData) {
                alert('Please generate medical data first');
                return;
            }

            const values = currentMedicalData.data.map(d => d.value);
            values.sort((a, b) => a - b);
            
            const n = values.length;
            const mean = values.reduce((sum, val) => sum + val, 0) / n;
            const median = n % 2 === 0 ? (values[n/2 - 1] + values[n/2]) / 2 : values[Math.floor(n/2)];
            
            // Mode (approximate for continuous data)
            const rounded = values.map(v => Math.round(v * 10) / 10);
            const frequency = {};
            rounded.forEach(val => frequency[val] = (frequency[val] || 0) + 1);
            const mode = Object.keys(frequency).reduce((a, b) => frequency[a] > frequency[b] ? a : b);
            
            // Variance and standard deviation
            const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / (n - 1);
            const stdDev = Math.sqrt(variance);
            
            // Quartiles
            const q1 = values[Math.floor(n * 0.25)];
            const q3 = values[Math.floor(n * 0.75)];
            const iqr = q3 - q1;
            
            // Additional measures
            const range = Math.max(...values) - Math.min(...values);
            const cv = (stdDev / mean) * 100;
            
            displayStatisticsResults({
                n, mean, median, mode: parseFloat(mode), stdDev, variance,
                q1, q3, iqr, range, cv, 
                min: Math.min(...values), 
                max: Math.max(...values)
            });
        }

        function displayStatisticsResults(stats) {
            document.getElementById('statisticsTable').innerHTML = `
                <h4>ü©∫ Descriptive Statistics Summary</h4>
                <div style="font-family: 'Roboto Mono', monospace; background: var(--pale-blue); padding: 30px; border-radius: 15px; margin: 25px 0;">
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; font-weight: 600; border-bottom: 2px solid #ccc; padding-bottom: 15px;">
                        <div>Measure</div>
                        <div>Value</div>
                        <div>Clinical Interpretation</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; padding: 15px 0;">
                        <div>Sample Size (n)</div>
                        <div class="statistic-display">${stats.n}</div>
                        <div>Adequate power for inference</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; padding: 15px 0; background: rgba(0, 123, 167, 0.1);">
                        <div>Mean</div>
                        <div class="statistic-display">${stats.mean.toFixed(2)}</div>
                        <div>Average patient outcome</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; padding: 15px 0;">
                        <div>Median</div>
                        <div class="statistic-display">${stats.median.toFixed(2)}</div>
                        <div>Typical patient experience</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; padding: 15px 0; background: rgba(0, 123, 167, 0.1);">
                        <div>Standard Deviation</div>
                        <div class="statistic-display">${stats.stdDev.toFixed(2)}</div>
                        <div>Variability around mean</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; padding: 15px 0;">
                        <div>IQR (Q3-Q1)</div>
                        <div class="statistic-display">${stats.iqr.toFixed(2)}</div>
                        <div>Middle 50% spread</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 25px; padding: 15px 0; background: rgba(0, 123, 167, 0.1);">
                        <div>Coefficient of Variation</div>
                        <div class="statistic-display">${stats.cv.toFixed(1)}%</div>
                        <div>${stats.cv > 50 ? 'High variability' : stats.cv > 25 ? 'Moderate variability' : 'Low variability'}</div>
                    </div>
                </div>
                <div class="medical-highlight">
                    <p><strong>ü©∫ Clinical Assessment:</strong> 
                    ${Math.abs(stats.mean - stats.median) > stats.stdDev * 0.5 ? 
                        'Data shows notable skewness; median may be more representative than mean' : 
                        'Data appears relatively symmetric; mean and median are comparable'}.
                    ${stats.cv > 50 ? 'High variability suggests heterogeneous patient population or measurement issues.' : 
                      stats.cv > 25 ? 'Moderate variability is typical for clinical data.' : 
                      'Low variability suggests homogeneous population or standardized measurements.'}
                    </p>
                </div>
            `;

            // Update statistics display
            document.getElementById('medicalStats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${stats.mean.toFixed(2)}</div>
                    <div class="stat-label">Mean</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.median.toFixed(2)}</div>
                    <div class="stat-label">Median</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.stdDev.toFixed(2)}</div>
                    <div class="stat-label">Standard Deviation</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.iqr.toFixed(2)}</div>
                    <div class="stat-label">IQR</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.cv.toFixed(1)}%</div>
                    <div class="stat-label">Coeff. of Variation</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.n}</div>
                    <div class="stat-label">Sample Size</div>
                </div>
            `;
        }

        function visualizeData() {
            if (!currentMedicalData) {
                alert('Please calculate descriptive statistics first');
                return;
            }

            generateDistributionChart();
            displayClinicalInterpretation();
        }

        function generateDistributionChart() {
            const ctx = document.getElementById('distributionChart').getContext('2d');
            
            if (distributionChart) {
                distributionChart.destroy();
            }

            const values = currentMedicalData.data.map(d => d.value);
            const mean = values.reduce((sum, val) => sum + val, 0) / values.length;
            const median = values.sort((a, b) => a - b)[Math.floor(values.length / 2)];

            // Create box plot data approximation
            const sortedValues = [...values].sort((a, b) => a - b);
            const q1 = sortedValues[Math.floor(values.length * 0.25)];
            const q3 = sortedValues[Math.floor(values.length * 0.75)];

            distributionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Min', 'Q1', 'Median', 'Mean', 'Q3', 'Max'],
                    datasets: [
                        {
                            label: 'Summary Statistics',
                            data: [Math.min(...values), q1, median, mean, q3, Math.max(...values)],
                            borderColor: '#007BA7',
                            backgroundColor: 'rgba(0, 123, 167, 0.1)',
                            borderWidth: 3,
                            pointRadius: 8,
                            pointBackgroundColor: ['#FF6B6B', '#20B2AA', '#4CAF50', '#FF7043', '#20B2AA', '#FF6B6B'],
                            pointBorderColor: '#007BA7',
                            pointBorderWidth: 2,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Five-Number Summary + Mean',
                            font: { size: 14, weight: 'bold' }
                        },
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'Summary Statistics' }
                        },
                        y: {
                            title: { display: true, text: currentMedicalData.dataset.outcome }
                        }
                    }
                }
            });
        }

        function displayClinicalInterpretation() {
            const dataset = currentMedicalData.dataset;
            
            document.getElementById('clinicalTable').innerHTML = `
                <h4>ü©∫ Clinical & Population Health Context</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                    <div class="stat-card" style="padding: 25px;">
                        <h5>Clinical Significance</h5>
                        <p><strong>Context:</strong> ${dataset.clinical_relevance}</p>
                        <p><strong>Typical Range:</strong> ${dataset.typical_values}</p>
                        <p><strong>Quality Indicators:</strong> ${dataset.quality_indicators}</p>
                    </div>
                    <div class="stat-card" style="padding: 25px;">
                        <h5>Population Health Application</h5>
                        <p><strong>Target Population:</strong> ${dataset.population}</p>
                        <p><strong>Key Factors:</strong> ${dataset.factors}</p>
                        <p><strong>Distribution Note:</strong> ${dataset.distribution_note}</p>
                    </div>
                </div>
                <div class="medical-highlight">
                    <p><strong>ü©∫ Evidence-Based Medicine Application:</strong> 
                    These descriptive statistics provide the foundation for clinical decision-making and population health planning. 
                    Understanding central tendency helps identify typical patient experiences, while variability measures indicate population 
                    heterogeneity and measurement precision. <span class="canada-context">Canadian health data</span> requires consideration 
                    of provincial variations, rural-urban differences, and demographic diversity when interpreting statistical summaries.
                    </p>
                </div>
            `;
        }

        // Assessment Functions
        function generateNewQuestion() {
            currentQuestion = assessmentQuestions[Math.floor(Math.random() * assessmentQuestions.length)];
            selectedAnswer = null;
            
            document.querySelector('.decision-question').textContent = currentQuestion.question;
            
            const optionsContainer = document.getElementById('assessmentOptions');
            optionsContainer.innerHTML = '';
            
            currentQuestion.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'decision-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('assessmentFeedback').innerHTML = '';
        }

        function selectAnswer(answerIndex) {
            selectedAnswer = answerIndex;
            
            document.querySelectorAll('.decision-option').forEach((option, index) => {
                option.classList.toggle('selected', index === answerIndex);
            });
        }

        function checkAnswer() {
            if (selectedAnswer === null) {
                alert('Please select an answer first');
                return;
            }
            
            const isCorrect = selectedAnswer === currentQuestion.correct;
            const feedbackClass = isCorrect ? 'feedback-success' : 'feedback-danger';
            const feedbackTitle = isCorrect ? '‚úì Correct!' : '‚úó Incorrect';
            
            document.getElementById('assessmentFeedback').innerHTML = `
                <div class="${feedbackClass}">
                    <h4>${feedbackTitle}</h4>
                    <p><strong>Explanation:</strong> ${currentQuestion.explanation}</p>
                    <p><strong>Correct Answer:</strong> ${currentQuestion.options[currentQuestion.correct]}</p>
                </div>
            `;
        }

        function showExpertSolution() {
            if (!currentQuestion) {
                generateNewQuestion();
                return;
            }
            
            document.getElementById('assessmentFeedback').innerHTML = `
                <div class="feedback-success">
                    <h4>ü©∫ Clinical Interpretation</h4>
                    <p><strong>Correct Answer:</strong> ${currentQuestion.options[currentQuestion.correct]}</p>
                    <p><strong>Medical Statistics Insight:</strong> ${currentQuestion.explanation}</p>
                    <p><strong>Clinical Application:</strong> Descriptive statistics form the foundation of evidence-based medicine by providing standardized methods for summarizing patient data, comparing treatments, and communicating findings. Understanding these principles is essential for interpreting medical literature and making informed clinical decisions.</p>
                </div>
            `;
        }

        // Initialize page
        window.addEventListener('load', function() {
            updateHealthDataset();
            generateNewQuestion();
        });
    </script>
</body>
</html>
